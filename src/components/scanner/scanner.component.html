<div class="relative flex flex-col h-full w-full overflow-hidden">

  <!-- Canvas Visualization Background -->
  <div class="absolute inset-0 z-0">
    <canvas #waveformCanvas class="w-full h-full"></canvas>
  </div>

  <!-- Main HUD Layer -->
  <div class="relative z-10 flex flex-col h-full p-4 justify-between pointer-events-none">

    <!-- Top HUD: Status -->
    <div class="w-full flex flex-col items-center pt-4">
      <div
        class="px-4 py-1 rounded-full bg-obsidian-900/80 border border-spectral-500/30 backdrop-blur-md shadow-lg shadow-spectral-500/10">
        <p class="text-xs font-mono font-bold tracking-[0.2em] uppercase" [class]="statusColorClass()">
          {{ status() }}
        </p>
      </div>
    </div>

    <!-- Center HUD: Reading -->
    <div class="flex flex-col items-center justify-center">
      <!-- Circular Radar Graphic (Static SVG) behind numbers -->
      <div class="absolute opacity-10 animate-spin-slow">
        <svg width="300" height="300" viewBox="0 0 100 100" fill="none" class="text-spectral-500">
          <circle cx="50" cy="50" r="48" stroke="currentColor" stroke-width="0.5" stroke-dasharray="2 2" />
          <circle cx="50" cy="50" r="35" stroke="currentColor" stroke-width="0.5" />
          <circle cx="50" cy="50" r="20" stroke="currentColor" stroke-width="0.5" stroke-dasharray="4 2" />
          <line x1="50" y1="0" x2="50" y2="100" stroke="currentColor" stroke-width="0.5" />
          <line x1="0" y1="50" x2="100" y2="50" stroke="currentColor" stroke-width="0.5" />
        </svg>
      </div>

      <div class="relative z-10 text-center">
        <h2
          class="text-8xl font-mono font-bold text-transparent bg-clip-text bg-gradient-to-b from-spectral-100 to-spectral-500 drop-shadow-[0_0_15px_rgba(6,182,212,0.5)]">
          {{ deviceState.emfReading().toFixed(1) }}
        </h2>
        <p class="text-xl font-mono text-spectral-400 tracking-widest mt-2">MICRO-TESLA</p>
      </div>
    </div>

    <!-- Bottom HUD: Instruments -->
    <div class="w-full flex gap-3 pb-4 pointer-events-auto">
      <div
        class="glass-panel rounded-xl flex-1 p-2 h-32 flex flex-col items-center justify-center overflow-hidden relative group">
        <div class="absolute inset-0 bg-spectral-500/5 group-hover:bg-spectral-500/10 transition-colors"></div>
        <p class="text-[0.6rem] text-spectral-600 uppercase mb-1 font-mono z-10">Triangulation</p>
        <app-geo-triangulator [emfReading]="deviceState.emfReading()" class="w-full h-full"></app-geo-triangulator>
      </div>

      <div
        class="glass-panel rounded-xl flex-1 p-2 h-32 flex flex-col items-center justify-center overflow-hidden relative group">
        <div class="absolute inset-0 bg-spectral-500/5 group-hover:bg-spectral-500/10 transition-colors"></div>
        <p class="text-[0.6rem] text-spectral-600 uppercase mb-1 font-mono z-10">Spectral Map</p>
        <app-spectral-map [emfReading]="deviceState.emfReading()" class="w-full h-full"></app-spectral-map>
      </div>
    </div>

  </div>
</div>