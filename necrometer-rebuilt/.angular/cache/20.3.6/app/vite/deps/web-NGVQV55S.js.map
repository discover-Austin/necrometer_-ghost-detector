{
  "version": 3,
  "sources": ["../../../../../../node_modules/@capacitor-community/camera-preview/dist/esm/web.js"],
  "sourcesContent": ["import { WebPlugin } from '@capacitor/core';\nexport class CameraPreviewWeb extends WebPlugin {\n    async start(options) {\n        // eslint-disable-next-line no-async-promise-executor\n        return new Promise(async (resolve, reject) => {\n            var _a;\n            await navigator.mediaDevices\n                .getUserMedia({\n                audio: !options.disableAudio,\n                video: true,\n            })\n                .then((stream) => {\n                // Stop any existing stream so we can request media with different constraints based on user input\n                stream.getTracks().forEach((track) => track.stop());\n            })\n                .catch((error) => {\n                reject(error);\n            });\n            const video = document.getElementById('video');\n            const parent = document.getElementById(options.parent);\n            if (!video) {\n                const videoElement = document.createElement('video');\n                videoElement.id = 'video';\n                videoElement.setAttribute('class', options.className || '');\n                // Don't flip video feed if camera is rear facing\n                if (options.position !== 'rear') {\n                    videoElement.setAttribute('style', '-webkit-transform: scaleX(-1); transform: scaleX(-1);');\n                }\n                const userAgent = navigator.userAgent.toLowerCase();\n                const isSafari = userAgent.includes('safari') && !userAgent.includes('chrome');\n                // Safari on iOS needs to have the autoplay, muted and playsinline attributes set for video.play() to be successful\n                // Without these attributes videoElement.play() will throw a NotAllowedError\n                // https://developer.apple.com/documentation/webkit/delivering_video_content_for_safari\n                if (isSafari) {\n                    videoElement.setAttribute('autoplay', 'true');\n                    videoElement.setAttribute('muted', 'true');\n                    videoElement.setAttribute('playsinline', 'true');\n                }\n                parent.appendChild(videoElement);\n                if ((_a = navigator.mediaDevices) === null || _a === void 0 ? void 0 : _a.getUserMedia) {\n                    const constraints = {\n                        video: {\n                            width: { ideal: options.width },\n                            height: { ideal: options.height },\n                        },\n                    };\n                    if (options.position === 'rear') {\n                        constraints.video.facingMode = 'environment';\n                        this.isBackCamera = true;\n                    }\n                    else {\n                        this.isBackCamera = false;\n                    }\n                    navigator.mediaDevices.getUserMedia(constraints).then(function (stream) {\n                        //video.src = window.URL.createObjectURL(stream);\n                        videoElement.srcObject = stream;\n                        videoElement.play();\n                        resolve();\n                    }, (err) => {\n                        reject(err);\n                    });\n                }\n            }\n            else {\n                reject({ message: 'camera already started' });\n            }\n        });\n    }\n    async startRecordVideo() {\n        throw this.unimplemented('Not implemented on web.');\n    }\n    async stopRecordVideo() {\n        throw this.unimplemented('Not implemented on web.');\n    }\n    async stop() {\n        const video = document.getElementById('video');\n        if (video) {\n            video.pause();\n            const st = video.srcObject;\n            const tracks = st.getTracks();\n            for (const track of tracks) {\n                track.stop();\n            }\n            video.remove();\n        }\n    }\n    async capture(options) {\n        return new Promise((resolve) => {\n            const video = document.getElementById('video');\n            const canvas = document.createElement('canvas');\n            // video.width = video.offsetWidth;\n            const context = canvas.getContext('2d');\n            canvas.width = video.videoWidth;\n            canvas.height = video.videoHeight;\n            // flip horizontally back camera isn't used\n            if (!this.isBackCamera) {\n                context.translate(video.videoWidth, 0);\n                context.scale(-1, 1);\n            }\n            context.drawImage(video, 0, 0, video.videoWidth, video.videoHeight);\n            let base64EncodedImage;\n            if (options.quality != undefined) {\n                base64EncodedImage = canvas\n                    .toDataURL('image/jpeg', options.quality / 100.0)\n                    .replace('data:image/jpeg;base64,', '');\n            }\n            else {\n                base64EncodedImage = canvas.toDataURL('image/png').replace('data:image/png;base64,', '');\n            }\n            resolve({\n                value: base64EncodedImage,\n            });\n        });\n    }\n    async captureSample(_options) {\n        return this.capture(_options);\n    }\n    async getSupportedFlashModes() {\n        throw new Error('getSupportedFlashModes not supported under the web platform');\n    }\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    async setFlashMode(_options) {\n        throw new Error('setFlashMode not supported under the web platform');\n    }\n    async flip() {\n        throw new Error('flip not supported under the web platform');\n    }\n    async setOpacity(_options) {\n        const video = document.getElementById('video');\n        if (!!video && !!_options['opacity']) {\n            video.style.setProperty('opacity', _options['opacity'].toString());\n        }\n    }\n    async isCameraStarted() {\n        throw this.unimplemented('Not implemented on web.');\n    }\n}\n"],
  "mappings": "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",
  "names": []
}
