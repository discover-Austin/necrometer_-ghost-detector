{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/grand/necrometer_-ghost-detector-1/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { signal } from '@angular/core';\nimport * as i0 from \"@angular/core\";\nexport let SensorService = /*#__PURE__*/(() => {\n  var _staticBlock;\n  class SensorService {\n    constructor() {\n      this.orientation = signal(null, ...(ngDevMode ? [{\n        debugName: \"orientation\"\n      }] : []));\n      this.motion = signal(null, ...(ngDevMode ? [{\n        debugName: \"motion\"\n      }] : []));\n      this.hasPermissions = signal(false, ...(ngDevMode ? [{\n        debugName: \"hasPermissions\"\n      }] : []));\n      // Using arrow functions to preserve `this` context in event handlers\n      this.handleOrientation = event => {\n        if (event.alpha !== null && event.beta !== null && event.gamma !== null) {\n          this.orientation.set({\n            alpha: event.alpha,\n            beta: event.beta,\n            gamma: event.gamma\n          });\n        }\n      };\n      this.handleMotion = event => {\n        if (event.accelerationIncludingGravity?.x) {\n          this.motion.set({\n            x: event.accelerationIncludingGravity.x,\n            y: event.accelerationIncludingGravity.y,\n            z: event.accelerationIncludingGravity.z\n          });\n        }\n      };\n    }\n    start() {\n      var _this = this;\n      return _asyncToGenerator(function* () {\n        if (typeof window === 'undefined' || typeof DeviceOrientationEvent === 'undefined') {\n          console.warn('Device Orientation API not supported.');\n          return;\n        }\n        // For iOS 13+ we need to request permission\n        if (typeof DeviceOrientationEvent.requestPermission === 'function') {\n          try {\n            const permissionState = yield DeviceOrientationEvent.requestPermission();\n            if (permissionState === 'granted') {\n              _this.hasPermissions.set(true);\n            } else {\n              console.warn('Permission for Device Orientation not granted.');\n              return;\n            }\n          } catch (error) {\n            console.error('Error requesting device orientation permission:', error);\n            return;\n          }\n        } else {\n          // For other browsers, permission is often granted by default or handled differently\n          _this.hasPermissions.set(true);\n        }\n        if (_this.hasPermissions()) {\n          window.addEventListener('deviceorientation', _this.handleOrientation, true);\n          window.addEventListener('devicemotion', _this.handleMotion, true);\n        }\n      })();\n    }\n    stop() {\n      if (typeof window !== 'undefined') {\n        window.removeEventListener('deviceorientation', this.handleOrientation, true);\n        window.removeEventListener('devicemotion', this.handleMotion, true);\n      }\n    }\n    static #_ = _staticBlock = () => (this.ɵfac = function SensorService_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || SensorService)();\n    }, this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n      token: SensorService,\n      factory: SensorService.ɵfac,\n      providedIn: 'root'\n    }));\n  }\n  _staticBlock();\n  return SensorService;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}