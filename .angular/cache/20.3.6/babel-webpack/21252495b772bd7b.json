{"ast":null,"code":"import { signal, effect } from '@angular/core';\nimport * as i0 from \"@angular/core\";\nconst UPGRADE_STORAGE_KEY = 'necrometer_upgrades';\nexport let UpgradeService = /*#__PURE__*/(() => {\n  var _staticBlock;\n  class UpgradeService {\n    constructor() {\n      // Start the user with a welcome bonus of credits\n      this.credits = signal(15, ...(ngDevMode ? [{\n        debugName: \"credits\"\n      }] : []));\n      this.isPro = signal(false, ...(ngDevMode ? [{\n        debugName: \"isPro\"\n      }] : []));\n      this.proMonthlyCreditStipend = 100;\n      this.loadState();\n      // Save state whenever credits or pro status changes\n      effect(() => {\n        this.saveState();\n      });\n    }\n    /**\n     * Spends a specified amount of credits.\n     * @param amount The number of credits to spend.\n     * @returns `true` if the user had enough credits, `false` otherwise.\n     */\n    spendCredits(amount) {\n      if (this.credits() >= amount) {\n        this.credits.update(c => c - amount);\n        return true;\n      }\n      return false;\n    }\n    /**\n     * Adds a specified amount of credits to the user's balance.\n     * @param amount The number of credits to add.\n     */\n    addCredits(amount) {\n      this.credits.update(c => c + amount);\n    }\n    /**\n     * Simulates subscribing the user to the Pro plan.\n     */\n    subscribeToPro() {\n      if (this.isPro()) return;\n      this.isPro.set(true);\n      this.addCredits(this.proMonthlyCreditStipend);\n    }\n    saveState() {\n      try {\n        const state = {\n          credits: this.credits(),\n          isPro: this.isPro()\n        };\n        localStorage.setItem(UPGRADE_STORAGE_KEY, JSON.stringify(state));\n      } catch (error) {\n        console.error('Error saving upgrade state to localStorage', error);\n      }\n    }\n    loadState() {\n      try {\n        const savedState = localStorage.getItem(UPGRADE_STORAGE_KEY);\n        if (savedState) {\n          const state = JSON.parse(savedState);\n          this.credits.set(state.credits ?? 15);\n          this.isPro.set(state.isPro ?? false);\n        }\n      } catch (error) {\n        console.error('Error loading upgrade state from localStorage', error);\n      }\n    }\n    static #_ = _staticBlock = () => (this.ɵfac = function UpgradeService_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || UpgradeService)();\n    }, this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n      token: UpgradeService,\n      factory: UpgradeService.ɵfac,\n      providedIn: 'root'\n    }));\n  }\n  _staticBlock();\n  return UpgradeService;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}