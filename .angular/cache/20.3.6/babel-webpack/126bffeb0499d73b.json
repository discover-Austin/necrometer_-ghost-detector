{"ast":null,"code":"import { EventEmitter, signal, computed, inject, effect } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { SpectralMapComponent } from '../spectral-map/spectral-map.component';\nimport { GeoTriangulatorComponent } from '../geo-triangulator/geo-triangulator.component';\nimport { DeviceStateService } from '../../services/device-state.service';\nimport * as i0 from \"@angular/core\";\nexport let ScannerComponent = /*#__PURE__*/(() => {\n  var _staticBlock;\n  class ScannerComponent {\n    constructor() {\n      this.detection = new EventEmitter();\n      this.status = signal('CALIBRATING...', ...(ngDevMode ? [{\n        debugName: \"status\"\n      }] : []));\n      this.lastDetectionTime = 0;\n      this.deviceState = inject(DeviceStateService);\n      this.barColorClass = computed(() => {\n        const reading = this.deviceState.emfReading();\n        if (reading > 90) return 'bg-red-500';\n        if (reading > 75) return 'bg-yellow-500';\n        if (reading > 40) return 'bg-teal-400';\n        return 'bg-green-500';\n      }, ...(ngDevMode ? [{\n        debugName: \"barColorClass\"\n      }] : []));\n      this.statusColorClass = computed(() => {\n        const reading = this.deviceState.emfReading();\n        if (reading > 90) return 'text-red-400 animate-pulse';\n        if (reading > 75) return 'text-yellow-400';\n        if (reading > 40) return 'text-teal-300';\n        return 'text-green-400';\n      }, ...(ngDevMode ? [{\n        debugName: \"statusColorClass\"\n      }] : []));\n      this.scannerContainerStyles = computed(() => {\n        const reading = this.deviceState.emfReading();\n        let opacity = 0;\n        let duration = 5;\n        let blur = 0;\n        if (reading > 5) {\n          opacity = reading / 100 * 0.4;\n          duration = Math.max(0.5, 3 - reading / 100 * 2.5); // Faster pulse with higher reading\n          blur = reading / 100 * 20;\n        }\n        return {\n          '--glow-color': `rgba(52, 211, 153, ${opacity})`,\n          '--glow-blur': `0 0 ${blur}px var(--glow-color)`,\n          'animationDuration': `${duration}s`\n        };\n      }, ...(ngDevMode ? [{\n        debugName: \"scannerContainerStyles\"\n      }] : []));\n      this.backgroundDistortionOpacity = computed(() => {\n        const reading = this.deviceState.emfReading();\n        if (reading < 10) return 0;\n        return Math.min(reading / 100 * 0.3, 0.3); // Max 30% opacity\n      }, ...(ngDevMode ? [{\n        debugName: \"backgroundDistortionOpacity\"\n      }] : []));\n      effect(() => {\n        const reading = this.deviceState.emfReading();\n        this.updateStatus(reading);\n        const detectionCooldown = 10000; // 10 seconds\n        const now = Date.now();\n        // Trigger a detection event if reading is critical and cooldown has passed\n        if (reading > 90 && now - this.lastDetectionTime > detectionCooldown) {\n          this.triggerDetection(reading);\n          this.lastDetectionTime = now;\n          // Reset EMF slightly to prevent immediate re-triggering\n          this.deviceState.emfReading.set(20);\n        }\n      });\n    }\n    updateStatus(reading) {\n      if (reading < 10) this.status.set('SYSTEM NOMINAL');else if (reading < 40) this.status.set('TRACE ENERGY DETECTED');else if (reading < 75) this.status.set('MODERATE FIELD DISTURBANCE');else if (reading < 90) this.status.set('HIGH EMF WARNING');else this.status.set('!!! CRITICAL EVENT IMMINENT !!!');\n    }\n    triggerDetection(reading) {\n      let strength = 'weak';\n      if (reading > 98) strength = 'critical';else if (reading > 95) strength = 'strong';else if (reading > 90) strength = 'moderate';\n      this.detection.emit({\n        emf: parseFloat(reading.toFixed(2)),\n        strength\n      });\n    }\n    static #_ = _staticBlock = () => (this.ɵfac = function ScannerComponent_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || ScannerComponent)();\n    }, this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: ScannerComponent,\n      selectors: [[\"app-scanner\"]],\n      outputs: {\n        detection: \"detection\"\n      },\n      decls: 24,\n      vars: 14,\n      consts: [[1, \"relative\", \"flex\", \"flex-col\", \"items-center\", \"justify-around\", \"h-full\", \"text-center\", \"p-2\", \"rounded-lg\", \"bg-gray-800/20\", \"border-2\", \"border-[var(--color-primary-500)]/20\", \"transition-all\", \"duration-300\", \"pulsating-container\"], [1, \"absolute\", \"inset-0\", \"distortion-overlay\", \"pointer-events-none\"], [1, \"w-full\", \"max-w-xs\", \"space-y-4\", \"z-10\"], [1, \"text-sm\", \"text-gray-400\", \"uppercase\", \"tracking-widest\"], [1, \"text-lg\", \"font-bold\", \"tracking-wider\"], [1, \"relative\", \"w-full\", \"h-24\", \"flex\", \"items-center\", \"justify-center\"], [1, \"scanline-overlay\"], [1, \"font-mono\", \"text-6xl\", \"font-bold\", \"text-[var(--color-primary-300)]\", \"z-10\", \"drop-shadow-[0_0_8px_rgba(110,231,183,0.8)]\"], [1, \"absolute\", \"bottom-4\", \"right-8\", \"font-mono\", \"text-lg\", \"text-[var(--color-primary-500)]\", \"z-10\"], [1, \"w-full\", \"bg-gray-700/50\", \"rounded-full\", \"h-4\", \"border\", \"border-gray-600\", \"overflow-hidden\"], [1, \"h-full\", \"rounded-full\", \"transition-all\", \"duration-150\"], [1, \"flex\", \"gap-2\", \"w-full\"], [1, \"flex-1\"], [3, \"emfReading\"], [1, \"text-gray-400\", \"text-xs\", \"pt-2\"]],\n      template: function ScannerComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 0);\n          i0.ɵɵelement(1, \"div\", 1);\n          i0.ɵɵelementStart(2, \"div\", 2)(3, \"div\")(4, \"p\", 3);\n          i0.ɵɵtext(5, \"System Status\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(6, \"p\", 4);\n          i0.ɵɵtext(7);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(8, \"div\", 5);\n          i0.ɵɵelement(9, \"div\", 6);\n          i0.ɵɵelementStart(10, \"p\", 7);\n          i0.ɵɵtext(11);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(12, \"p\", 8);\n          i0.ɵɵtext(13, \"\\u00B5T\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(14, \"div\", 9);\n          i0.ɵɵelement(15, \"div\", 10);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(16, \"div\", 11)(17, \"div\", 12);\n          i0.ɵɵelement(18, \"app-geo-triangulator\", 13);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(19, \"div\", 12);\n          i0.ɵɵelement(20, \"app-spectral-map\", 13);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(21, \"div\", 14)(22, \"p\");\n          i0.ɵɵtext(23, \"Monitoring ambient electromagnetic fields for spectral variance.\");\n          i0.ɵɵelementEnd()()()();\n        }\n        if (rf & 2) {\n          i0.ɵɵstyleMap(ctx.scannerContainerStyles());\n          i0.ɵɵadvance();\n          i0.ɵɵstyleProp(\"opacity\", ctx.backgroundDistortionOpacity());\n          i0.ɵɵadvance(5);\n          i0.ɵɵclassMap(ctx.statusColorClass());\n          i0.ɵɵadvance();\n          i0.ɵɵtextInterpolate(ctx.status());\n          i0.ɵɵadvance(4);\n          i0.ɵɵtextInterpolate1(\" \", ctx.deviceState.emfReading().toFixed(2), \" \");\n          i0.ɵɵadvance(4);\n          i0.ɵɵclassMap(ctx.barColorClass());\n          i0.ɵɵstyleProp(\"width\", ctx.deviceState.emfReading(), \"%\");\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"emfReading\", ctx.deviceState.emfReading());\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"emfReading\", ctx.deviceState.emfReading());\n        }\n      },\n      dependencies: [CommonModule, SpectralMapComponent, GeoTriangulatorComponent],\n      styles: [\".scanline-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;background:linear-gradient(to bottom,#12101000 50%,#00000040 50%),linear-gradient(90deg,#ff00000f,#00ff0005,#0000ff0f);background-size:100% 4px,6px 100%;animation:_ngcontent-%COMP%_scanline 10s linear infinite;z-index:5;pointer-events:none}@keyframes _ngcontent-%COMP%_scanline{0%{background-position:0 0}to{background-position:0 100%}}.distortion-overlay[_ngcontent-%COMP%]{width:100%;height:100%;position:absolute;top:0;left:0;background-image:url(\\\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 800 800'%3E%3Cfilter id='n' x='0' y='0'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.7' numOctaves='10' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.5'/%3E%3C/svg%3E\\\");background-repeat:no-repeat;background-size:cover;opacity:0;transition:opacity .5s ease-in-out;z-index:0}@keyframes _ngcontent-%COMP%_pulse-glow{0%,to{box-shadow:var(--glow-blur)}50%{box-shadow:0 0 0 var(--glow-color)}}.pulsating-container[_ngcontent-%COMP%]{animation-name:_ngcontent-%COMP%_pulse-glow;animation-timing-function:ease-in-out;animation-iteration-count:infinite}\"],\n      changeDetection: 0\n    }));\n  }\n  _staticBlock();\n  return ScannerComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}