{"ast":null,"code":"import { signal, effect } from '@angular/core';\nimport * as i0 from \"@angular/core\";\nconst UPGRADE_STORAGE_KEY = 'necrometer_upgrades';\nexport let UpgradeService = /*#__PURE__*/(() => {\n  var _staticBlock;\n  class UpgradeService {\n    constructor() {\n      // Start the user with a welcome bonus of credits\n      this.credits = signal(15, ...(ngDevMode ? [{\n        debugName: \"credits\"\n      }] : []));\n      this.isPro = signal(false, ...(ngDevMode ? [{\n        debugName: \"isPro\"\n      }] : []));\n      this.proMonthlyCreditStipend = 100;\n      this.loadState();\n      // Save state whenever credits or pro status changes\n      effect(() => {\n        this.saveState();\n      });\n    }\n    /**\n     * Spends a specified amount of credits.\n     * @param amount The number of credits to spend.\n     * @returns `true` if the user had enough credits, `false` otherwise.\n     */\n    spendCredits(amount) {\n      if (this.credits() >= amount) {\n        this.credits.update(c => c - amount);\n        return true;\n      }\n      return false;\n    }\n    /**\n     * Adds a specified amount of credits to the user's balance.\n     * @param amount The number of credits to add.\n     */\n    addCredits(amount) {\n      this.credits.update(c => c + amount);\n    }\n    /**\n     * Simulates subscribing the user to the Pro plan.\n     */\n    subscribeToPro() {\n      if (this.isPro()) return;\n      this.isPro.set(true);\n      this.addCredits(this.proMonthlyCreditStipend);\n    }\n    saveState() {\n      try {\n        const state = {\n          credits: this.credits(),\n          isPro: this.isPro()\n        };\n        localStorage.setItem(UPGRADE_STORAGE_KEY, JSON.stringify(state));\n      } catch (error) {\n        console.error('Error saving upgrade state to localStorage', error);\n      }\n    }\n    loadState() {\n      try {\n        const savedState = localStorage.getItem(UPGRADE_STORAGE_KEY);\n        if (savedState) {\n          const state = JSON.parse(savedState);\n          this.credits.set(state.credits ?? 15);\n          this.isPro.set(state.isPro ?? false);\n        }\n      } catch (error) {\n        console.error('Error loading upgrade state from localStorage', error);\n      }\n    }\n    static #_ = _staticBlock = () => (this.ɵfac = function UpgradeService_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || UpgradeService)();\n    }, this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n      token: UpgradeService,\n      factory: UpgradeService.ɵfac,\n      providedIn: 'root'\n    }));\n  }\n  _staticBlock();\n  return UpgradeService;\n})();","map":{"version":3,"names":["signal","effect","UPGRADE_STORAGE_KEY","UpgradeService","_staticBlock","constructor","credits","ngDevMode","debugName","isPro","proMonthlyCreditStipend","loadState","saveState","spendCredits","amount","update","c","addCredits","subscribeToPro","set","state","localStorage","setItem","JSON","stringify","error","console","savedState","getItem","parse","_","factory","ɵfac","providedIn"],"sources":["C:\\Users\\grand\\necrometer_-ghost-detector-1\\src\\services\\upgrade.service.ts"],"sourcesContent":["import { Injectable, signal, effect } from '@angular/core';\r\n\r\nconst UPGRADE_STORAGE_KEY = 'necrometer_upgrades';\r\n\r\ninterface UpgradeState {\r\n  credits: number;\r\n  isPro: boolean;\r\n}\r\n\r\n@Injectable({\r\n  providedIn: 'root',\r\n})\r\nexport class UpgradeService {\r\n  // Start the user with a welcome bonus of credits\r\n  credits = signal(15);\r\n  isPro = signal(false);\r\n  \r\n  private readonly proMonthlyCreditStipend = 100;\r\n\r\n  constructor() {\r\n    this.loadState();\r\n    // Save state whenever credits or pro status changes\r\n    effect(() => {\r\n      this.saveState();\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Spends a specified amount of credits.\r\n   * @param amount The number of credits to spend.\r\n   * @returns `true` if the user had enough credits, `false` otherwise.\r\n   */\r\n  spendCredits(amount: number): boolean {\r\n    if (this.credits() >= amount) {\r\n      this.credits.update(c => c - amount);\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * Adds a specified amount of credits to the user's balance.\r\n   * @param amount The number of credits to add.\r\n   */\r\n  addCredits(amount: number) {\r\n    this.credits.update(c => c + amount);\r\n  }\r\n\r\n  /**\r\n   * Simulates subscribing the user to the Pro plan.\r\n   */\r\n  subscribeToPro() {\r\n    if (this.isPro()) return;\r\n    this.isPro.set(true);\r\n    this.addCredits(this.proMonthlyCreditStipend);\r\n  }\r\n\r\n  private saveState(): void {\r\n    try {\r\n      const state: UpgradeState = {\r\n        credits: this.credits(),\r\n        isPro: this.isPro(),\r\n      };\r\n      localStorage.setItem(UPGRADE_STORAGE_KEY, JSON.stringify(state));\r\n    } catch (error) {\r\n      console.error('Error saving upgrade state to localStorage', error);\r\n    }\r\n  }\r\n\r\n  private loadState(): void {\r\n    try {\r\n      const savedState = localStorage.getItem(UPGRADE_STORAGE_KEY);\r\n      if (savedState) {\r\n        const state: UpgradeState = JSON.parse(savedState);\r\n        this.credits.set(state.credits ?? 15);\r\n        this.isPro.set(state.isPro ?? false);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading upgrade state from localStorage', error);\r\n    }\r\n  }\r\n}\r\n"],"mappings":"AAAA,SAAqBA,MAAM,EAAEC,MAAM,QAAQ,eAAe;;AAE1D,MAAMC,mBAAmB,GAAG,qBAAqB;AAUjD,WAAaC,cAAc;EAAA,IAAAC,YAAA;EAArB,MAAOD,cAAc;IAOzBE,YAAA;MANA;MACA,KAAAC,OAAO,GAAGN,MAAM,CAAC,EAAE,MAAAO,SAAA;QAAAC,SAAA;MAAA,SAAC;MACpB,KAAAC,KAAK,GAAGT,MAAM,CAAC,KAAK,MAAAO,SAAA;QAAAC,SAAA;MAAA,SAAC;MAEJ,KAAAE,uBAAuB,GAAG,GAAG;MAG5C,IAAI,CAACC,SAAS,EAAE;MAChB;MACAV,MAAM,CAAC,MAAK;QACV,IAAI,CAACW,SAAS,EAAE;MAClB,CAAC,CAAC;IACJ;IAEA;;;;;IAKAC,YAAYA,CAACC,MAAc;MACzB,IAAI,IAAI,CAACR,OAAO,EAAE,IAAIQ,MAAM,EAAE;QAC5B,IAAI,CAACR,OAAO,CAACS,MAAM,CAACC,CAAC,IAAIA,CAAC,GAAGF,MAAM,CAAC;QACpC,OAAO,IAAI;MACb;MACA,OAAO,KAAK;IACd;IAEA;;;;IAIAG,UAAUA,CAACH,MAAc;MACvB,IAAI,CAACR,OAAO,CAACS,MAAM,CAACC,CAAC,IAAIA,CAAC,GAAGF,MAAM,CAAC;IACtC;IAEA;;;IAGAI,cAAcA,CAAA;MACZ,IAAI,IAAI,CAACT,KAAK,EAAE,EAAE;MAClB,IAAI,CAACA,KAAK,CAACU,GAAG,CAAC,IAAI,CAAC;MACpB,IAAI,CAACF,UAAU,CAAC,IAAI,CAACP,uBAAuB,CAAC;IAC/C;IAEQE,SAASA,CAAA;MACf,IAAI;QACF,MAAMQ,KAAK,GAAiB;UAC1Bd,OAAO,EAAE,IAAI,CAACA,OAAO,EAAE;UACvBG,KAAK,EAAE,IAAI,CAACA,KAAK;SAClB;QACDY,YAAY,CAACC,OAAO,CAACpB,mBAAmB,EAAEqB,IAAI,CAACC,SAAS,CAACJ,KAAK,CAAC,CAAC;MAClE,CAAC,CAAC,OAAOK,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,4CAA4C,EAAEA,KAAK,CAAC;MACpE;IACF;IAEQd,SAASA,CAAA;MACf,IAAI;QACF,MAAMgB,UAAU,GAAGN,YAAY,CAACO,OAAO,CAAC1B,mBAAmB,CAAC;QAC5D,IAAIyB,UAAU,EAAE;UACd,MAAMP,KAAK,GAAiBG,IAAI,CAACM,KAAK,CAACF,UAAU,CAAC;UAClD,IAAI,CAACrB,OAAO,CAACa,GAAG,CAACC,KAAK,CAACd,OAAO,IAAI,EAAE,CAAC;UACrC,IAAI,CAACG,KAAK,CAACU,GAAG,CAACC,KAAK,CAACX,KAAK,IAAI,KAAK,CAAC;QACtC;MACF,CAAC,CAAC,OAAOgB,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,+CAA+C,EAAEA,KAAK,CAAC;MACvE;IACF;IAAC,QAAAK,CAAA,GAAA1B,YAAA,GAAAA,CAAA,M;uCApEUD,cAAc;IAAA,G;aAAdA,cAAc;MAAA4B,OAAA,EAAd5B,cAAc,CAAA6B,IAAA;MAAAC,UAAA,EAFb;IAAM;;;SAEP9B,cAAc;AAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}