{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/grand/necrometer_-ghost-detector-1/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { signal, inject, computed, effect } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { ScannerComponent } from './components/scanner/scanner.component';\nimport { LogbookComponent } from './components/logbook/logbook.component';\nimport { VisionComponent } from './components/vision/vision.component';\nimport { EvpComponent } from './components/evp/evp.component';\nimport { EchoesComponent } from './components/echoes/echoes.component';\nimport { UpgradeComponent } from './components/upgrade/upgrade.component';\nimport { GeminiService } from './services/gemini.service';\nimport { DeviceStateService } from './services/device-state.service';\nimport { SplashScreen } from '@capacitor/splash-screen';\nimport { UpgradeService } from './services/upgrade.service';\nimport { CameraPreview } from '@capacitor-community/camera-preview';\nimport { AudioService } from './services/audio.service';\nimport { PersistenceService } from './services/persistence.service';\nimport { SensorService } from './services/sensor.service';\nimport * as i0 from \"@angular/core\";\nconst _c0 = [\"mainContent\"];\nfunction AppComponent_Case_24_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r2 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"app-scanner\", 43);\n    i0.ɵɵlistener(\"detection\", function AppComponent_Case_24_Template_app_scanner_detection_0_listener($event) {\n      i0.ɵɵrestoreView(_r2);\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.handleDetection($event));\n    });\n    i0.ɵɵelementEnd();\n  }\n}\nfunction AppComponent_Case_25_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"app-vision\", 21);\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"detections\", ctx_r2.detections());\n  }\n}\nfunction AppComponent_Case_26_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"app-logbook\", 44);\n    i0.ɵɵlistener(\"containEntity\", function AppComponent_Case_26_Template_app_logbook_containEntity_0_listener($event) {\n      i0.ɵɵrestoreView(_r4);\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.handleContainEntity($event));\n    });\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"detections\", ctx_r2.detections())(\"isLoading\", ctx_r2.isLoading())(\"error\", ctx_r2.error());\n  }\n}\nfunction AppComponent_Case_27_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"app-evp\");\n  }\n}\nfunction AppComponent_Case_28_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"app-echoes\");\n  }\n}\nfunction AppComponent_Case_29_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"app-upgrade\");\n  }\n}\nfunction AppComponent_Conditional_48_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"span\", 36);\n  }\n}\nexport let AppComponent = /*#__PURE__*/(() => {\n  var _staticBlock;\n  class AppComponent {\n    constructor() {\n      this.persistenceService = inject(PersistenceService);\n      this.activeView = signal('scanner', ...(ngDevMode ? [{\n        debugName: \"activeView\"\n      }] : []));\n      this.activeViewIndex = signal(0, ...(ngDevMode ? [{\n        debugName: \"activeViewIndex\"\n      }] : []));\n      this.detections = signal(this.persistenceService.loadDetections(), ...(ngDevMode ? [{\n        debugName: \"detections\"\n      }] : []));\n      this.isLoading = signal(false, ...(ngDevMode ? [{\n        debugName: \"isLoading\"\n      }] : []));\n      this.error = signal(null, ...(ngDevMode ? [{\n        debugName: \"error\"\n      }] : []));\n      this.manifestationImage = signal(null, ...(ngDevMode ? [{\n        debugName: \"manifestationImage\"\n      }] : []));\n      this.cameraPermissionError = signal(null, ...(ngDevMode ? [{\n        debugName: \"cameraPermissionError\"\n      }] : []));\n      this.geminiService = inject(GeminiService);\n      this.deviceState = inject(DeviceStateService);\n      this.upgradeService = inject(UpgradeService);\n      this.audioService = inject(AudioService);\n      this.sensorService = inject(SensorService);\n      this.isCameraActive = false;\n      this.isAudioInitialized = false;\n      this.appStateListener = null;\n      this.hasNewDetections = signal(false, ...(ngDevMode ? [{\n        debugName: \"hasNewDetections\"\n      }] : []));\n      // Global visual effects driven by EMF reading\n      this.globalStaticOpacity = computed(() => {\n        const reading = this.deviceState.emfReading();\n        if (reading < 20) return 0;\n        return Math.min(reading / 100 * 0.4, 0.4);\n      }, ...(ngDevMode ? [{\n        debugName: \"globalStaticOpacity\"\n      }] : []));\n      this.globalNoiseOpacity = computed(() => {\n        const reading = this.deviceState.emfReading();\n        if (reading < 40) return 0;\n        return Math.min((reading - 40) / 60 * 0.15, 0.15);\n      }, ...(ngDevMode ? [{\n        debugName: \"globalNoiseOpacity\"\n      }] : []));\n      // TODO: Replace with your deployed proxy server URL and shared token.\n      // This is the recommended way to use the Gemini API in a production app.\n      // See server/README.server.md for more information on setting up the proxy server.\n      this.geminiService.setProxyConfig('http://localhost:4000', 'necrometer-client-token-a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6');\n      effect(() => {\n        this.audioService.updateStaticLevel(this.deviceState.emfReading());\n      });\n      // Save detections to local storage whenever they change\n      effect(() => {\n        this.persistenceService.saveDetections(this.detections());\n      });\n      // Animate view changes\n      effect(() => {\n        this.activeView(); // depend on activeView\n        if (this.mainContentRef) {\n          const element = this.mainContentRef.nativeElement;\n          element.classList.remove('view-fade-in');\n          // Trigger reflow to restart animation\n          void element.offsetWidth;\n          element.classList.add('view-fade-in');\n        }\n      });\n    }\n    ngAfterViewInit() {\n      SplashScreen.hide();\n      this.sensorService.start();\n    }\n    ngOnDestroy() {\n      this.sensorService.stop();\n    }\n    initializeAudio() {\n      var _this = this;\n      return _asyncToGenerator(function* () {\n        if (!_this.isAudioInitialized) {\n          yield _this.audioService.init();\n          _this.isAudioInitialized = true;\n        }\n      })();\n    }\n    startCamera() {\n      var _this2 = this;\n      return _asyncToGenerator(function* () {\n        if (_this2.isCameraActive) return;\n        const attemptStart = /*#__PURE__*/function () {\n          var _ref = _asyncToGenerator(function* (position) {\n            const cameraPreviewOptions = {\n              position,\n              toBack: true,\n              parent: 'camera-container',\n              className: 'camera-preview-class'\n            };\n            yield CameraPreview.start(cameraPreviewOptions);\n          });\n          return function attemptStart(_x) {\n            return _ref.apply(this, arguments);\n          };\n        }();\n        try {\n          // First, try to get the rear camera\n          yield attemptStart('rear');\n          _this2.isCameraActive = true;\n          _this2.cameraPermissionError.set(null);\n        } catch (rearError) {\n          const rearErrorMessage = rearError instanceof Error ? rearError.message : String(rearError);\n          if (rearErrorMessage.toLowerCase().includes('requested device not found')) {\n            console.warn(\"Rear camera not found, attempting front camera.\");\n            try {\n              // Fallback to the front camera\n              yield attemptStart('front');\n              _this2.isCameraActive = true;\n              _this2.cameraPermissionError.set(null);\n            } catch (frontError) {\n              const frontErrorMessage = frontError instanceof Error ? frontError.message : String(frontError);\n              if (frontErrorMessage.toLowerCase().includes('requested device not found')) {\n                // If front camera also fails with \"not found\", gracefully fail without an error overlay.\n                // This is common in web/dev environments.\n                console.warn(\"No camera device found (tried rear and front). Proceeding without camera preview.\");\n                _this2.isCameraActive = false;\n                _this2.cameraPermissionError.set(null); // Ensure no error is shown\n              } else {\n                // It was a different error with the front camera (like permissions)\n                console.error(\"Error starting front camera preview:\", frontError);\n                _this2.handleCameraError(frontError);\n              }\n            }\n          } else {\n            // Handle other errors from the rear camera attempt (like permission denied)\n            console.error(\"Error starting rear camera preview:\", rearError);\n            _this2.handleCameraError(rearError);\n          }\n        }\n      })();\n    }\n    handleCameraError(err) {\n      const errorMessage = err instanceof Error ? err.message : String(err);\n      if (errorMessage.toLowerCase().includes('permission')) {\n        this.cameraPermissionError.set(\"Camera permission has been denied. To use the Necrometer, please enable camera access in your device or browser's app settings.\");\n      } else if (errorMessage.toLowerCase().includes('requested device not found')) {\n        this.cameraPermissionError.set(\"No suitable camera was found on your device. The Necrometer requires a camera to function.\");\n      } else {\n        this.cameraPermissionError.set(\"Failed to start the camera. Please ensure permissions are granted and try restarting the app.\");\n      }\n    }\n    stopCamera() {\n      var _this3 = this;\n      return _asyncToGenerator(function* () {\n        if (!_this3.isCameraActive) return;\n        _this3.isCameraActive = false;\n        try {\n          yield CameraPreview.stop();\n        } catch (e) {\n          console.warn(\"Could not stop camera preview\", e);\n        }\n      })();\n    }\n    handleDetection(event) {\n      if (this.isLoading()) return;\n      this.isLoading.set(true);\n      this.error.set(null);\n      this.activeView.set('logbook');\n      this.audioService.playDetectionSound();\n      this.geminiService.getEntityProfile(event.strength).then(profile => {\n        const newDetection = {\n          ...profile,\n          id: Date.now(),\n          timestamp: new Date(),\n          emfReading: event.emf\n        };\n        this.detections.update(currentDetections => [newDetection, ...currentDetections]);\n        this.trackNewDetection();\n      }).catch(err => {\n        console.error('Error getting entity profile:', err);\n        this.error.set('AI analysis failed. The connection to the spectral plane may be unstable.');\n      }).finally(() => {\n        this.isLoading.set(false);\n      });\n    }\n    handleContainEntity(entityToContain) {\n      this.detections.update(currentDetections => currentDetections.map(d => d.id === entityToContain.id ? {\n        ...d,\n        contained: true,\n        instability: 0\n      } : d));\n    }\n    changeView(view, index) {\n      this.initializeAudio();\n      this.audioService.playUISound();\n      this.activeView.set(view);\n      this.activeViewIndex.set(index);\n    }\n    trackNewDetection() {\n      if (this.activeView() !== 'logbook') {\n        this.hasNewDetections.set(true);\n      }\n    }\n    viewLogbook(index) {\n      this.initializeAudio();\n      this.audioService.playUISound();\n      this.changeView('logbook', index);\n      this.hasNewDetections.set(false);\n    }\n    static #_ = _staticBlock = () => (this.ɵfac = function AppComponent_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || AppComponent)();\n    }, this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: AppComponent,\n      selectors: [[\"app-root\"]],\n      viewQuery: function AppComponent_Query(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵviewQuery(_c0, 5);\n        }\n        if (rf & 2) {\n          let _t;\n          i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.mainContentRef = _t.first);\n        }\n      },\n      hostVars: 2,\n      hostBindings: function AppComponent_HostBindings(rf, ctx) {\n        if (rf & 2) {\n          i0.ɵɵclassProp(\"pro-theme\", ctx.upgradeService.isPro());\n        }\n      },\n      decls: 66,\n      vars: 51,\n      consts: [[\"mainContent\", \"\"], [1, \"relative\", \"flex\", \"flex-col\", \"h-screen\", \"max-w-md\", \"mx-auto\", \"bg-obsidian-950\", \"border-x\", \"border-spectral-900/50\", \"shadow-2xl\", \"shadow-spectral-500/10\", \"overflow-hidden\", \"font-sans\", \"selection:bg-spectral-500/30\"], [1, \"absolute\", \"inset-0\", \"pointer-events-none\", \"z-20\", \"vision-overlay\", \"mix-blend-overlay\"], [1, \"absolute\", \"inset-0\", \"pointer-events-none\", \"z-20\", \"vision-noise-overlay\", \"mix-blend-hard-light\"], [1, \"scanlines\", \"z-50\"], [1, \"relative\", \"z-30\", \"flex\", \"flex-col\", \"h-full\", \"transition-all\", \"duration-500\"], [1, \"h-[72px]\", \"shrink-0\", \"px-4\", \"py-3\", \"border-b\", \"border-spectral-500/20\", \"bg-obsidian-900/80\", \"backdrop-blur-md\", \"flex\", \"justify-between\", \"items-center\", \"z-40\", \"relative\", \"overflow-hidden\"], [1, \"absolute\", \"top-0\", \"left-1/2\", \"-translate-x-1/2\", \"w-3/4\", \"h-1\", \"bg-spectral-400/50\", \"blur-[4px]\"], [1, \"flex\", \"flex-col\", \"z-10\"], [1, \"text-2xl\", \"font-bold\", \"text-spectral-400\", \"tracking-[0.2em]\", \"uppercase\", \"font-mono\", \"drop-shadow-[0_0_8px_rgba(34,211,238,0.6)]\"], [1, \"flex\", \"items-center\", \"gap-2\"], [1, \"w-1.5\", \"h-1.5\", \"rounded-full\", \"bg-red-500\", \"animate-pulse\"], [1, \"text-[0.65rem]\", \"text-spectral-600\", \"uppercase\", \"tracking-widest\", \"font-mono\"], [1, \"group\", \"relative\", \"flex\", \"items-center\", \"gap-2\", \"px-3\", \"py-1.5\", \"rounded-full\", \"border\", \"border-warning-500/30\", \"bg-warning-500/5\", \"hover:bg-warning-500/10\", \"transition-all\", \"cursor-pointer\", \"overflow-hidden\", 3, \"click\"], [1, \"absolute\", \"inset-0\", \"bg-warning-400/10\", \"translate-y-full\", \"group-hover:translate-y-0\", \"transition-transform\", \"duration-300\"], [\"xmlns\", \"http://www.w3.org/2000/svg\", \"viewBox\", \"0 0 20 20\", \"fill\", \"currentColor\", 1, \"w-4\", \"h-4\", \"text-warning-400\"], [\"fill-rule\", \"evenodd\", \"d\", \"M10 18a8 8 0 100-16 8 8 0 000 16zm1-11a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V7z\", \"clip-rule\", \"evenodd\"], [1, \"font-mono\", \"font-bold\", \"text-xs\", \"text-warning-300\", \"relative\", \"z-10\"], [1, \"flex-grow\", \"relative\", \"overflow-y-auto\", \"overflow-x-hidden\", \"scrollbar-hide\"], [1, \"absolute\", \"inset-0\", \"z-0\", \"opacity-[0.03]\", 2, \"background-image\", \"radial-gradient(#22d3ee 1px, transparent 1px)\", \"background-size\", \"20px 20px\"], [1, \"relative\", \"z-10\", \"min-h-full\", \"p-4\", \"pb-20\"], [3, \"detections\"], [3, \"detections\", \"isLoading\", \"error\"], [1, \"h-[80px]\", \"shrink-0\", \"relative\", \"bg-obsidian-950/90\", \"backdrop-blur-xl\", \"border-t\", \"border-spectral-500/20\", \"z-50\"], [1, \"flex\", \"justify-around\", \"items-center\", \"h-full\", \"px-2\"], [1, \"group\", \"relative\", \"flex\", \"flex-col\", \"items-center\", \"justify-center\", \"w-14\", \"h-14\", \"rounded-xl\", \"transition-all\", \"duration-300\", 3, \"click\"], [1, \"absolute\", \"inset-0\", \"bg-spectral-400/20\", \"blur-md\", \"rounded-full\", \"opacity-0\", \"group-hover:opacity-100\", \"transition-opacity\", \"duration-500\"], [\"xmlns\", \"http://www.w3.org/2000/svg\", \"fill\", \"none\", \"viewBox\", \"0 0 24 24\", \"stroke\", \"currentColor\", 1, \"h-6\", \"w-6\", \"z-10\", \"transition-colors\", \"duration-300\"], [\"stroke-linecap\", \"round\", \"stroke-linejoin\", \"round\", \"stroke-width\", \"2\", \"d\", \"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z\"], [\"stroke-linecap\", \"round\", \"stroke-linejoin\", \"round\", \"stroke-width\", \"2\", \"d\", \"M15 11a3 3 0 11-6 0 3 3 0 016 0z\"], [1, \"text-[0.6rem]\", \"uppercase\", \"tracking-wider\", \"mt-1\", \"font-mono\", \"transition-colors\", \"duration-300\"], [\"xmlns\", \"http://www.w3.org/2000/svg\", \"fill\", \"none\", \"viewBox\", \"0 0 24 24\", \"stroke\", \"currentColor\", \"stroke-width\", \"2\", 1, \"h-6\", \"w-6\", \"z-10\", \"transition-colors\", \"duration-300\"], [\"stroke-linecap\", \"round\", \"stroke-linejoin\", \"round\", \"d\", \"M15 12a3 3 0 11-6 0 3 3 0 016 0z\"], [\"stroke-linecap\", \"round\", \"stroke-linejoin\", \"round\", \"d\", \"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\"], [1, \"relative\", \"-top-6\", 3, \"click\"], [1, \"w-16\", \"h-16\", \"rounded-full\", \"bg-obsidian-900\", \"border-2\", \"border-spectral-500/50\", \"flex\", \"items-center\", \"justify-center\", \"shadow-[0_0_15px_rgba(6,182,212,0.3)]\", \"group\", \"hover:scale-105\", \"transition-transform\", \"duration-300\"], [1, \"absolute\", \"top-0\", \"right-0\", \"w-4\", \"h-4\", \"bg-red-500\", \"rounded-full\", \"border-2\", \"border-obsidian-900\", \"animate-pulse\", \"z-20\"], [1, \"absolute\", \"inset-0\", \"rounded-full\", \"bg-spectral-500/10\", \"animate-pulse-slow\"], [\"xmlns\", \"http://www.w3.org/2000/svg\", \"fill\", \"none\", \"viewBox\", \"0 0 24 24\", \"stroke\", \"currentColor\", 1, \"h-7\", \"w-7\", \"text-spectral-300\", \"group-hover:text-spectral-100\", \"transition-colors\"], [\"stroke-linecap\", \"round\", \"stroke-linejoin\", \"round\", \"stroke-width\", \"2\", \"d\", \"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253\"], [1, \"text-[0.6rem]\", \"uppercase\", \"tracking-wider\", \"mt-1\", \"font-mono\", \"text-spectral-400\", \"absolute\", \"-bottom-5\", \"left-1/2\", \"-translate-x-1/2\"], [\"stroke-linecap\", \"round\", \"stroke-linejoin\", \"round\", \"d\", \"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z\"], [\"stroke-linecap\", \"round\", \"stroke-linejoin\", \"round\", \"d\", \"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z\"], [3, \"detection\"], [3, \"containEntity\", \"detections\", \"isLoading\", \"error\"]],\n      template: function AppComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          const _r1 = i0.ɵɵgetCurrentView();\n          i0.ɵɵelementStart(0, \"div\", 1);\n          i0.ɵɵelement(1, \"div\", 2)(2, \"div\", 3)(3, \"div\", 4);\n          i0.ɵɵelementStart(4, \"div\", 5)(5, \"header\", 6);\n          i0.ɵɵelement(6, \"div\", 7);\n          i0.ɵɵelementStart(7, \"div\", 8)(8, \"h1\", 9);\n          i0.ɵɵtext(9, \" NECROMETER \");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(10, \"div\", 10);\n          i0.ɵɵelement(11, \"span\", 11);\n          i0.ɵɵelementStart(12, \"p\", 12);\n          i0.ɵɵtext(13, \"System Active\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(14, \"div\", 13);\n          i0.ɵɵlistener(\"click\", function AppComponent_Template_div_click_14_listener() {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.changeView(\"store\", 5));\n          });\n          i0.ɵɵelement(15, \"div\", 14);\n          i0.ɵɵnamespaceSVG();\n          i0.ɵɵelementStart(16, \"svg\", 15);\n          i0.ɵɵelement(17, \"path\", 16);\n          i0.ɵɵelementEnd();\n          i0.ɵɵnamespaceHTML();\n          i0.ɵɵelementStart(18, \"span\", 17);\n          i0.ɵɵtext(19);\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(20, \"main\", 18, 0);\n          i0.ɵɵelement(22, \"div\", 19);\n          i0.ɵɵelementStart(23, \"div\", 20);\n          i0.ɵɵconditionalCreate(24, AppComponent_Case_24_Template, 1, 0, \"app-scanner\")(25, AppComponent_Case_25_Template, 1, 1, \"app-vision\", 21)(26, AppComponent_Case_26_Template, 1, 3, \"app-logbook\", 22)(27, AppComponent_Case_27_Template, 1, 0, \"app-evp\")(28, AppComponent_Case_28_Template, 1, 0, \"app-echoes\")(29, AppComponent_Case_29_Template, 1, 0, \"app-upgrade\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(30, \"footer\", 23)(31, \"div\", 24)(32, \"button\", 25);\n          i0.ɵɵlistener(\"click\", function AppComponent_Template_button_click_32_listener() {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.changeView(\"scanner\", 0));\n          });\n          i0.ɵɵelement(33, \"div\", 26);\n          i0.ɵɵnamespaceSVG();\n          i0.ɵɵelementStart(34, \"svg\", 27);\n          i0.ɵɵelement(35, \"path\", 28)(36, \"path\", 29);\n          i0.ɵɵelementEnd();\n          i0.ɵɵnamespaceHTML();\n          i0.ɵɵelementStart(37, \"span\", 30);\n          i0.ɵɵtext(38, \"Scan\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(39, \"button\", 25);\n          i0.ɵɵlistener(\"click\", function AppComponent_Template_button_click_39_listener() {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.changeView(\"vision\", 1));\n          });\n          i0.ɵɵelement(40, \"div\", 26);\n          i0.ɵɵnamespaceSVG();\n          i0.ɵɵelementStart(41, \"svg\", 31);\n          i0.ɵɵelement(42, \"path\", 32)(43, \"path\", 33);\n          i0.ɵɵelementEnd();\n          i0.ɵɵnamespaceHTML();\n          i0.ɵɵelementStart(44, \"span\", 30);\n          i0.ɵɵtext(45, \"Vis\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(46, \"button\", 34);\n          i0.ɵɵlistener(\"click\", function AppComponent_Template_button_click_46_listener() {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.viewLogbook(2));\n          });\n          i0.ɵɵelementStart(47, \"div\", 35);\n          i0.ɵɵconditionalCreate(48, AppComponent_Conditional_48_Template, 1, 0, \"span\", 36);\n          i0.ɵɵelement(49, \"div\", 37);\n          i0.ɵɵnamespaceSVG();\n          i0.ɵɵelementStart(50, \"svg\", 38);\n          i0.ɵɵelement(51, \"path\", 39);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵnamespaceHTML();\n          i0.ɵɵelementStart(52, \"span\", 40);\n          i0.ɵɵtext(53, \"Logs\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(54, \"button\", 25);\n          i0.ɵɵlistener(\"click\", function AppComponent_Template_button_click_54_listener() {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.changeView(\"evp\", 3));\n          });\n          i0.ɵɵelement(55, \"div\", 26);\n          i0.ɵɵnamespaceSVG();\n          i0.ɵɵelementStart(56, \"svg\", 31);\n          i0.ɵɵelement(57, \"path\", 41);\n          i0.ɵɵelementEnd();\n          i0.ɵɵnamespaceHTML();\n          i0.ɵɵelementStart(58, \"span\", 30);\n          i0.ɵɵtext(59, \"EVP\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(60, \"button\", 25);\n          i0.ɵɵlistener(\"click\", function AppComponent_Template_button_click_60_listener() {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.changeView(\"echoes\", 4));\n          });\n          i0.ɵɵelement(61, \"div\", 26);\n          i0.ɵɵnamespaceSVG();\n          i0.ɵɵelementStart(62, \"svg\", 31);\n          i0.ɵɵelement(63, \"path\", 42);\n          i0.ɵɵelementEnd();\n          i0.ɵɵnamespaceHTML();\n          i0.ɵɵelementStart(64, \"span\", 30);\n          i0.ɵɵtext(65, \"Echo\");\n          i0.ɵɵelementEnd()()()()()();\n        }\n        if (rf & 2) {\n          let tmp_6_0;\n          i0.ɵɵadvance();\n          i0.ɵɵstyleProp(\"opacity\", ctx.globalStaticOpacity());\n          i0.ɵɵadvance();\n          i0.ɵɵstyleProp(\"opacity\", ctx.globalNoiseOpacity());\n          i0.ɵɵadvance(2);\n          i0.ɵɵclassProp(\"bg-obsidian-950/80\", ctx.activeView() !== \"vision\")(\"backdrop-blur-sm\", ctx.activeView() !== \"vision\");\n          i0.ɵɵadvance(15);\n          i0.ɵɵtextInterpolate1(\"\", ctx.upgradeService.credits(), \" CR\");\n          i0.ɵɵadvance(5);\n          i0.ɵɵconditional((tmp_6_0 = ctx.activeView()) === \"scanner\" ? 24 : tmp_6_0 === \"vision\" ? 25 : tmp_6_0 === \"logbook\" ? 26 : tmp_6_0 === \"evp\" ? 27 : tmp_6_0 === \"echoes\" ? 28 : tmp_6_0 === \"store\" ? 29 : -1);\n          i0.ɵɵadvance(8);\n          i0.ɵɵclassProp(\"bg-spectral-500/10\", ctx.activeView() === \"scanner\");\n          i0.ɵɵadvance(2);\n          i0.ɵɵclassProp(\"text-spectral-300\", ctx.activeView() === \"scanner\")(\"text-slate-500\", ctx.activeView() !== \"scanner\");\n          i0.ɵɵadvance(3);\n          i0.ɵɵclassProp(\"text-spectral-400\", ctx.activeView() === \"scanner\")(\"text-slate-600\", ctx.activeView() !== \"scanner\");\n          i0.ɵɵadvance(2);\n          i0.ɵɵclassProp(\"bg-spectral-500/10\", ctx.activeView() === \"vision\");\n          i0.ɵɵadvance(2);\n          i0.ɵɵclassProp(\"text-spectral-300\", ctx.activeView() === \"vision\")(\"text-slate-500\", ctx.activeView() !== \"vision\");\n          i0.ɵɵadvance(3);\n          i0.ɵɵclassProp(\"text-spectral-400\", ctx.activeView() === \"vision\")(\"text-slate-600\", ctx.activeView() !== \"vision\");\n          i0.ɵɵadvance(4);\n          i0.ɵɵconditional(ctx.hasNewDetections() ? 48 : -1);\n          i0.ɵɵadvance(6);\n          i0.ɵɵclassProp(\"bg-spectral-500/10\", ctx.activeView() === \"evp\");\n          i0.ɵɵadvance(2);\n          i0.ɵɵclassProp(\"text-spectral-300\", ctx.activeView() === \"evp\")(\"text-slate-500\", ctx.activeView() !== \"evp\");\n          i0.ɵɵadvance(2);\n          i0.ɵɵclassProp(\"text-spectral-400\", ctx.activeView() === \"evp\")(\"text-slate-600\", ctx.activeView() !== \"evp\");\n          i0.ɵɵadvance(2);\n          i0.ɵɵclassProp(\"bg-spectral-500/10\", ctx.activeView() === \"echoes\");\n          i0.ɵɵadvance(2);\n          i0.ɵɵclassProp(\"text-spectral-300\", ctx.activeView() === \"echoes\")(\"text-slate-500\", ctx.activeView() !== \"echoes\");\n          i0.ɵɵadvance(2);\n          i0.ɵɵclassProp(\"text-spectral-400\", ctx.activeView() === \"echoes\")(\"text-slate-600\", ctx.activeView() !== \"echoes\");\n        }\n      },\n      dependencies: [CommonModule, ScannerComponent, LogbookComponent, VisionComponent, EvpComponent, EchoesComponent, UpgradeComponent],\n      encapsulation: 2,\n      changeDetection: 0\n    }));\n  }\n  _staticBlock();\n  return AppComponent;\n})();","map":{"version":3,"names":["signal","inject","computed","effect","CommonModule","ScannerComponent","LogbookComponent","VisionComponent","EvpComponent","EchoesComponent","UpgradeComponent","GeminiService","DeviceStateService","SplashScreen","UpgradeService","CameraPreview","AudioService","PersistenceService","SensorService","i0","ɵɵelementStart","ɵɵlistener","AppComponent_Case_24_Template_app_scanner_detection_0_listener","$event","ɵɵrestoreView","_r2","ctx_r2","ɵɵnextContext","ɵɵresetView","handleDetection","ɵɵelementEnd","ɵɵelement","ɵɵproperty","detections","AppComponent_Case_26_Template_app_logbook_containEntity_0_listener","_r4","handleContainEntity","isLoading","error","AppComponent","_staticBlock","constructor","persistenceService","activeView","ngDevMode","debugName","activeViewIndex","loadDetections","manifestationImage","cameraPermissionError","geminiService","deviceState","upgradeService","audioService","sensorService","isCameraActive","isAudioInitialized","appStateListener","hasNewDetections","globalStaticOpacity","reading","emfReading","Math","min","globalNoiseOpacity","setProxyConfig","updateStaticLevel","saveDetections","mainContentRef","element","nativeElement","classList","remove","offsetWidth","add","ngAfterViewInit","hide","start","ngOnDestroy","stop","initializeAudio","_this","_asyncToGenerator","init","startCamera","_this2","attemptStart","_ref","position","cameraPreviewOptions","toBack","parent","className","_x","apply","arguments","set","rearError","rearErrorMessage","Error","message","String","toLowerCase","includes","console","warn","frontError","frontErrorMessage","handleCameraError","err","errorMessage","stopCamera","_this3","e","event","playDetectionSound","getEntityProfile","strength","then","profile","newDetection","id","Date","now","timestamp","emf","update","currentDetections","trackNewDetection","catch","finally","entityToContain","map","d","contained","instability","changeView","view","index","playUISound","viewLogbook","_","selectors","viewQuery","AppComponent_Query","rf","ctx","ɵɵclassProp","isPro","ɵɵtext","AppComponent_Template_div_click_14_listener","_r1","ɵɵconditionalCreate","AppComponent_Case_24_Template","AppComponent_Case_25_Template","AppComponent_Case_26_Template","AppComponent_Case_27_Template","AppComponent_Case_28_Template","AppComponent_Case_29_Template","AppComponent_Template_button_click_32_listener","AppComponent_Template_button_click_39_listener","AppComponent_Template_button_click_46_listener","AppComponent_Conditional_48_Template","AppComponent_Template_button_click_54_listener","AppComponent_Template_button_click_60_listener","ɵɵadvance","ɵɵstyleProp","ɵɵtextInterpolate1","credits","ɵɵconditional","tmp_6_0","encapsulation","changeDetection"],"sources":["C:\\Users\\grand\\necrometer_-ghost-detector-1\\src\\app.component.ts","C:\\Users\\grand\\necrometer_-ghost-detector-1\\src\\app.component.html"],"sourcesContent":["import { Component, ChangeDetectionStrategy, signal, inject, AfterViewInit, OnDestroy, computed, effect, ViewChild, ElementRef, Renderer2 } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { ScannerComponent } from './components/scanner/scanner.component';\r\nimport { LogbookComponent } from './components/logbook/logbook.component';\r\nimport { VisionComponent } from './components/vision/vision.component';\r\nimport { EvpComponent } from './components/evp/evp.component';\r\nimport { EchoesComponent } from './components/echoes/echoes.component';\r\nimport { UpgradeComponent } from './components/upgrade/upgrade.component';\r\nimport { GeminiService } from './services/gemini.service';\r\nimport { DetectedEntity, DetectionEvent } from './types';\r\nimport { DeviceStateService } from './services/device-state.service';\r\nimport { SplashScreen } from '@capacitor/splash-screen';\r\nimport { UpgradeService } from './services/upgrade.service';\r\nimport { CameraPreview, CameraPreviewOptions } from '@capacitor-community/camera-preview';\r\nimport { AudioService } from './services/audio.service';\r\nimport { PersistenceService } from './services/persistence.service';\r\nimport { SensorService } from './services/sensor.service';\r\nimport { PluginListenerHandle } from '@capacitor/core';\r\nimport { App } from '@capacitor/app';\r\n\r\ntype View = 'scanner' | 'vision' | 'logbook' | 'evp' | 'echoes' | 'store';\r\n\r\n@Component({\r\n  selector: 'app-root',\r\n  templateUrl: './app.component.html',\r\n  changeDetection: ChangeDetectionStrategy.OnPush,\r\n  imports: [\r\n    CommonModule,\r\n    ScannerComponent,\r\n    LogbookComponent,\r\n    VisionComponent,\r\n    EvpComponent,\r\n    EchoesComponent,\r\n    UpgradeComponent,\r\n  ],\r\n  host: {\r\n    '[class.pro-theme]': 'upgradeService.isPro()',\r\n  }\r\n})\r\nexport class AppComponent implements AfterViewInit, OnDestroy {\r\n  private persistenceService = inject(PersistenceService);\r\n    activeView = signal<View>('scanner');\r\n    activeViewIndex = signal(0);\r\n    detections = signal<DetectedEntity[]>(this.persistenceService.loadDetections());\r\n    isLoading = signal(false);\r\n    error = signal<string | null>(null);\r\n    manifestationImage = signal<string | null>(null);\r\n    cameraPermissionError = signal<string | null>(null);\r\n    \r\n    private geminiService = inject(GeminiService);\r\n    deviceState = inject(DeviceStateService);\r\n    upgradeService = inject(UpgradeService);\r\n    audioService = inject(AudioService);\r\n    private sensorService = inject(SensorService);\r\n    isCameraActive = false;\r\n    private isAudioInitialized = false;\r\n    private appStateListener: any | null = null;\r\n  \r\n    @ViewChild('mainContent') mainContentRef!: ElementRef<HTMLElement>;\r\n  \r\n      constructor() {\r\n        // TODO: Replace with your deployed proxy server URL and shared token.\r\n        // This is the recommended way to use the Gemini API in a production app.\r\n        // See server/README.server.md for more information on setting up the proxy server.\r\n        this.geminiService.setProxyConfig('http://localhost:4000', 'necrometer-client-token-a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6');\r\n    \r\n        effect(() => {\r\n          this.audioService.updateStaticLevel(this.deviceState.emfReading());\r\n        });\r\n    \r\n        // Save detections to local storage whenever they change\r\n        effect(() => {\r\n          this.persistenceService.saveDetections(this.detections());\r\n        });\r\n    \r\n        // Animate view changes\r\n        effect(() => {\r\n          this.activeView(); // depend on activeView\r\n          if (this.mainContentRef) {\r\n            const element = this.mainContentRef.nativeElement;\r\n            element.classList.remove('view-fade-in');\r\n            // Trigger reflow to restart animation\r\n            void element.offsetWidth; \r\n            element.classList.add('view-fade-in');\r\n          }\r\n        });\r\n      }\r\n    \r\n      ngAfterViewInit() {\r\n        SplashScreen.hide();\r\n        this.sensorService.start();\r\n      }\r\n    \r\n      ngOnDestroy() {\r\n        this.sensorService.stop();\r\n      }  \r\n    private async initializeAudio() {\r\n      if (!this.isAudioInitialized) {\r\n        await this.audioService.init();\r\n        this.isAudioInitialized = true;\r\n      }\r\n    }\r\n  \r\n    async startCamera() {\r\n      if (this.isCameraActive) return;\r\n  \r\n      const attemptStart = async (position: 'rear' | 'front') => {\r\n        const cameraPreviewOptions: CameraPreviewOptions = {\r\n          position,\r\n          toBack: true,\r\n          parent: 'camera-container',\r\n          className: 'camera-preview-class',\r\n        };\r\n        await CameraPreview.start(cameraPreviewOptions);\r\n      };\r\n  \r\n      try {\r\n        // First, try to get the rear camera\r\n        await attemptStart('rear');\r\n        this.isCameraActive = true;\r\n        this.cameraPermissionError.set(null);\r\n      } catch (rearError) {\r\n        const rearErrorMessage = rearError instanceof Error ? rearError.message : String(rearError);\r\n        \r\n        if (rearErrorMessage.toLowerCase().includes('requested device not found')) {\r\n          console.warn(\"Rear camera not found, attempting front camera.\");\r\n          try {\r\n            // Fallback to the front camera\r\n            await attemptStart('front');\r\n            this.isCameraActive = true;\r\n            this.cameraPermissionError.set(null);\r\n          } catch (frontError) {\r\n             const frontErrorMessage = frontError instanceof Error ? frontError.message : String(frontError);\r\n             if (frontErrorMessage.toLowerCase().includes('requested device not found')) {\r\n                // If front camera also fails with \"not found\", gracefully fail without an error overlay.\r\n                // This is common in web/dev environments.\r\n                console.warn(\"No camera device found (tried rear and front). Proceeding without camera preview.\");\r\n                this.isCameraActive = false;\r\n                this.cameraPermissionError.set(null); // Ensure no error is shown\r\n             } else {\r\n               // It was a different error with the front camera (like permissions)\r\n               console.error(\"Error starting front camera preview:\", frontError);\r\n               this.handleCameraError(frontError);\r\n             }\r\n          }\r\n        } else {\r\n          // Handle other errors from the rear camera attempt (like permission denied)\r\n           console.error(\"Error starting rear camera preview:\", rearError);\r\n          this.handleCameraError(rearError);\r\n        }\r\n      }\r\n    }\r\n  \r\n    private handleCameraError(err: unknown) {\r\n      const errorMessage = err instanceof Error ? err.message : String(err);\r\n      if (errorMessage.toLowerCase().includes('permission')) {\r\n        this.cameraPermissionError.set(\"Camera permission has been denied. To use the Necrometer, please enable camera access in your device or browser's app settings.\");\r\n      } else if (errorMessage.toLowerCase().includes('requested device not found')) {\r\n         this.cameraPermissionError.set(\"No suitable camera was found on your device. The Necrometer requires a camera to function.\");\r\n      } else {\r\n        this.cameraPermissionError.set(\"Failed to start the camera. Please ensure permissions are granted and try restarting the app.\");\r\n      }\r\n    }\r\n  \r\n    async stopCamera() {\r\n      if (!this.isCameraActive) return;\r\n      this.isCameraActive = false;\r\n      try {\r\n          await CameraPreview.stop();\r\n      } catch(e) {\r\n          console.warn(\"Could not stop camera preview\", e);\r\n      }\r\n    }\r\n  \r\n    handleDetection(event: DetectionEvent) {\r\n      if (this.isLoading()) return;\r\n      \r\n      this.isLoading.set(true);\r\n      this.error.set(null);\r\n      this.activeView.set('logbook');\r\n      this.audioService.playDetectionSound();\r\n  \r\n      this.geminiService.getEntityProfile(event.strength)\r\n        .then(profile => {\r\n          const newDetection: DetectedEntity = {\r\n            ...profile,\r\n            id: Date.now(),\r\n            timestamp: new Date(),\r\n            emfReading: event.emf,\r\n          };\r\n          this.detections.update(currentDetections => [newDetection, ...currentDetections]);\r\n          this.trackNewDetection();\r\n        })\r\n        .catch(err => {\r\n          console.error('Error getting entity profile:', err);\r\n          this.error.set('AI analysis failed. The connection to the spectral plane may be unstable.');\r\n        })\r\n        .finally(() => {\r\n          this.isLoading.set(false);\r\n        });\r\n    }\r\n  \r\n    handleContainEntity(entityToContain: DetectedEntity) {\r\n      this.detections.update(currentDetections =>\r\n        currentDetections.map(d =>\r\n          d.id === entityToContain.id ? { ...d, contained: true, instability: 0 } : d\r\n        )\r\n      );\r\n    }\r\n  \r\n    changeView(view: View, index: number) {\r\n      this.initializeAudio();\r\n      this.audioService.playUISound();\r\n      this.activeView.set(view);\r\n      this.activeViewIndex.set(index);\r\n    }\r\n  \r\n    hasNewDetections = signal(false);\r\n  \r\n    trackNewDetection() {\r\n      if (this.activeView() !== 'logbook') {\r\n        this.hasNewDetections.set(true);\r\n      }\r\n    }\r\n  \r\n    viewLogbook(index: number) {\r\n      this.initializeAudio();\r\n      this.audioService.playUISound();\r\n      this.changeView('logbook', index);\r\n      this.hasNewDetections.set(false);\r\n    }\r\n\r\n  // Global visual effects driven by EMF reading\r\n  globalStaticOpacity = computed(() => {\r\n    const reading = this.deviceState.emfReading();\r\n    if (reading < 20) return 0;\r\n    return Math.min((reading / 100) * 0.4, 0.4);\r\n  });\r\n  \r\n  globalNoiseOpacity = computed(() => {\r\n    const reading = this.deviceState.emfReading();\r\n    if (reading < 40) return 0;\r\n    return Math.min(((reading - 40) / 60) * 0.15, 0.15);\r\n  });\r\n}\r\n","<!-- Main container -->\r\n<div class=\"relative flex flex-col h-screen max-w-md mx-auto bg-obsidian-950 border-x border-spectral-900/50 shadow-2xl shadow-spectral-500/10 overflow-hidden font-sans selection:bg-spectral-500/30\">\r\n  \r\n  <!-- Global Static/Glitch Overlay -->\r\n  <div class=\"absolute inset-0 pointer-events-none z-20 vision-overlay mix-blend-overlay\" [style.opacity]=\"globalStaticOpacity()\"></div>\r\n  <div class=\"absolute inset-0 pointer-events-none z-20 vision-noise-overlay mix-blend-hard-light\" [style.opacity]=\"globalNoiseOpacity()\"></div>\r\n  <div class=\"scanlines z-50\"></div>\r\n\r\n  <!-- App UI, positioned above the camera feed and overlays -->\r\n  <div class=\"relative z-30 flex flex-col h-full transition-all duration-500\" \r\n       [class.bg-obsidian-950/80]=\"activeView() !== 'vision'\" \r\n       [class.backdrop-blur-sm]=\"activeView() !== 'vision'\">\r\n       \r\n    <!-- Header -->\r\n    <header class=\"h-[72px] shrink-0 px-4 py-3 border-b border-spectral-500/20 bg-obsidian-900/80 backdrop-blur-md flex justify-between items-center z-40 relative overflow-hidden\">\r\n        <!-- Glow effect behind header -->\r\n        <div class=\"absolute top-0 left-1/2 -translate-x-1/2 w-3/4 h-1 bg-spectral-400/50 blur-[4px]\"></div>\r\n\r\n      <div class=\"flex flex-col z-10\">\r\n        <h1 class=\"text-2xl font-bold text-spectral-400 tracking-[0.2em] uppercase font-mono drop-shadow-[0_0_8px_rgba(34,211,238,0.6)]\">\r\n            NECROMETER\r\n        </h1>\r\n        <div class=\"flex items-center gap-2\">\r\n            <span class=\"w-1.5 h-1.5 rounded-full bg-red-500 animate-pulse\"></span>\r\n            <p class=\"text-[0.65rem] text-spectral-600 uppercase tracking-widest font-mono\">System Active</p>\r\n        </div>\r\n      </div>\r\n\r\n       <div (click)=\"changeView('store', 5)\" class=\"group relative flex items-center gap-2 px-3 py-1.5 rounded-full border border-warning-500/30 bg-warning-500/5 hover:bg-warning-500/10 transition-all cursor-pointer overflow-hidden\">\r\n           <div class=\"absolute inset-0 bg-warning-400/10 translate-y-full group-hover:translate-y-0 transition-transform duration-300\"></div>\r\n           <svg class=\"w-4 h-4 text-warning-400\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\" fill=\"currentColor\"><path fill-rule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm1-11a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V7z\" clip-rule=\"evenodd\" /></svg>\r\n           <span class=\"font-mono font-bold text-xs text-warning-300 relative z-10\">{{ upgradeService.credits() }} CR</span>\r\n       </div>\r\n    </header>\r\n\r\n    <!-- Main Content Area -->\r\n    <main #mainContent class=\"flex-grow relative overflow-y-auto overflow-x-hidden scrollbar-hide\">\r\n        <!-- Grid Background Pattern -->\r\n        <div class=\"absolute inset-0 z-0 opacity-[0.03]\" \r\n             style=\"background-image: radial-gradient(#22d3ee 1px, transparent 1px); background-size: 20px 20px;\">\r\n        </div>\r\n\r\n      <div class=\"relative z-10 min-h-full p-4 pb-20\">\r\n        @switch (activeView()) {\r\n            @case ('scanner') {\r\n              <app-scanner (detection)=\"handleDetection($event)\"></app-scanner>\r\n            }\r\n            @case ('vision') {\r\n              <app-vision [detections]=\"detections()\"></app-vision>\r\n            }\r\n            @case ('logbook') {\r\n              <app-logbook \r\n                [detections]=\"detections()\" \r\n                [isLoading]=\"isLoading()\" \r\n                [error]=\"error()\"\r\n                (containEntity)=\"handleContainEntity($event)\">\r\n              </app-logbook>\r\n            }\r\n            @case ('evp') {\r\n              <app-evp></app-evp>\r\n            }\r\n            @case ('echoes') {\r\n              <app-echoes></app-echoes>\r\n            }\r\n            @case ('store') {\r\n              <app-upgrade></app-upgrade>\r\n            }\r\n          }\r\n      </div>\r\n    </main>\r\n\r\n    <!-- Footer / Navigation -->\r\n    <footer class=\"h-[80px] shrink-0 relative bg-obsidian-950/90 backdrop-blur-xl border-t border-spectral-500/20 z-50\">\r\n      \r\n      <!-- Tab Bar -->\r\n      <div class=\"flex justify-around items-center h-full px-2\">\r\n        \r\n        <!-- Scanner -->\r\n        <button (click)=\"changeView('scanner', 0)\" \r\n                class=\"group relative flex flex-col items-center justify-center w-14 h-14 rounded-xl transition-all duration-300\"\r\n                [class.bg-spectral-500/10]=\"activeView() === 'scanner'\">\r\n            <div class=\"absolute inset-0 bg-spectral-400/20 blur-md rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-500\"></div>\r\n            <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"h-6 w-6 z-10 transition-colors duration-300\" [class.text-spectral-300]=\"activeView() === 'scanner'\" [class.text-slate-500]=\"activeView() !== 'scanner'\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z\" /><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M15 11a3 3 0 11-6 0 3 3 0 016 0z\" />\r\n            </svg>\r\n            <span class=\"text-[0.6rem] uppercase tracking-wider mt-1 font-mono transition-colors duration-300\" [class.text-spectral-400]=\"activeView() === 'scanner'\" [class.text-slate-600]=\"activeView() !== 'scanner'\">Scan</span>\r\n        </button>\r\n\r\n        <!-- Vision -->\r\n        <button (click)=\"changeView('vision', 1)\" \r\n                class=\"group relative flex flex-col items-center justify-center w-14 h-14 rounded-xl transition-all duration-300\"\r\n                [class.bg-spectral-500/10]=\"activeView() === 'vision'\">\r\n            <div class=\"absolute inset-0 bg-spectral-400/20 blur-md rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-500\"></div>\r\n            <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"h-6 w-6 z-10 transition-colors duration-300\" [class.text-spectral-300]=\"activeView() === 'vision'\" [class.text-slate-500]=\"activeView() !== 'vision'\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" stroke-width=\"2\">\r\n                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" /><path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\r\n            </svg>\r\n            <span class=\"text-[0.6rem] uppercase tracking-wider mt-1 font-mono transition-colors duration-300\" [class.text-spectral-400]=\"activeView() === 'vision'\" [class.text-slate-600]=\"activeView() !== 'vision'\">Vis</span>\r\n        </button>\r\n\r\n        <!-- Logbook (Central) -->\r\n        <button (click)=\"viewLogbook(2)\" class=\"relative -top-6\">\r\n            <div class=\"w-16 h-16 rounded-full bg-obsidian-900 border-2 border-spectral-500/50 flex items-center justify-center shadow-[0_0_15px_rgba(6,182,212,0.3)] group hover:scale-105 transition-transform duration-300\">\r\n                @if (hasNewDetections()) {\r\n                    <span class=\"absolute top-0 right-0 w-4 h-4 bg-red-500 rounded-full border-2 border-obsidian-900 animate-pulse z-20\"></span>\r\n                }\r\n                <div class=\"absolute inset-0 rounded-full bg-spectral-500/10 animate-pulse-slow\"></div>\r\n                <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"h-7 w-7 text-spectral-300 group-hover:text-spectral-100 transition-colors\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253\" />\r\n                </svg>\r\n            </div>\r\n            <span class=\"text-[0.6rem] uppercase tracking-wider mt-1 font-mono text-spectral-400 absolute -bottom-5 left-1/2 -translate-x-1/2\">Logs</span>\r\n        </button>\r\n\r\n        <!-- EVP -->\r\n        <button (click)=\"changeView('evp', 3)\" \r\n                class=\"group relative flex flex-col items-center justify-center w-14 h-14 rounded-xl transition-all duration-300\"\r\n                [class.bg-spectral-500/10]=\"activeView() === 'evp'\">\r\n            <div class=\"absolute inset-0 bg-spectral-400/20 blur-md rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-500\"></div>\r\n            <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"h-6 w-6 z-10 transition-colors duration-300\" [class.text-spectral-300]=\"activeView() === 'evp'\" [class.text-slate-500]=\"activeView() !== 'evp'\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" stroke-width=\"2\">\r\n                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z\" />\r\n            </svg>\r\n            <span class=\"text-[0.6rem] uppercase tracking-wider mt-1 font-mono transition-colors duration-300\" [class.text-spectral-400]=\"activeView() === 'evp'\" [class.text-slate-600]=\"activeView() !== 'evp'\">EVP</span>\r\n        </button>\r\n\r\n        <!-- Echoes -->\r\n        <button (click)=\"changeView('echoes', 4)\" \r\n                class=\"group relative flex flex-col items-center justify-center w-14 h-14 rounded-xl transition-all duration-300\"\r\n                [class.bg-spectral-500/10]=\"activeView() === 'echoes'\">\r\n            <div class=\"absolute inset-0 bg-spectral-400/20 blur-md rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-500\"></div>\r\n            <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"h-6 w-6 z-10 transition-colors duration-300\" [class.text-spectral-300]=\"activeView() === 'echoes'\" [class.text-slate-500]=\"activeView() !== 'echoes'\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" stroke-width=\"2\">\r\n                 <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z\" />\r\n            </svg>\r\n            <span class=\"text-[0.6rem] uppercase tracking-wider mt-1 font-mono transition-colors duration-300\" [class.text-spectral-400]=\"activeView() === 'echoes'\" [class.text-slate-600]=\"activeView() !== 'echoes'\">Echo</span>\r\n        </button>\r\n      </div>\r\n    </footer>\r\n  </div>\r\n</div>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}