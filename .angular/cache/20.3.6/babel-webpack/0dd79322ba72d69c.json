{"ast":null,"code":"import { effect } from '@angular/core';\nimport * as i0 from \"@angular/core\";\nconst _c0 = [\"spectralCanvas\"];\nexport let SpectralMapComponent = /*#__PURE__*/(() => {\n  var _staticBlock;\n  class SpectralMapComponent {\n    constructor() {\n      this.emfReading = 0;\n      this.particles = [];\n      this.animationFrameId = null;\n      this.width = 0;\n      this.height = 0;\n      effect(() => {\n        if (!this.ctx) return;\n        const reading = this.emfReading;\n        const targetParticleCount = Math.floor(reading / 100 * 350); // Increased density\n        while (this.particles.length < targetParticleCount) {\n          this.particles.push(this.createParticle());\n        }\n        while (this.particles.length > targetParticleCount && this.particles.length > 0) {\n          this.particles.pop();\n        }\n      });\n    }\n    ngAfterViewInit() {\n      const canvas = this.canvasRef.nativeElement;\n      const context = canvas.getContext('2d');\n      if (!context) {\n        console.error('Failed to get 2D context');\n        return;\n      }\n      this.ctx = context;\n      const rect = canvas.parentElement.getBoundingClientRect();\n      this.width = canvas.width = rect.width;\n      this.height = canvas.height = rect.height;\n      this.startAnimation();\n    }\n    ngOnDestroy() {\n      if (this.animationFrameId) {\n        cancelAnimationFrame(this.animationFrameId);\n      }\n    }\n    createParticle() {\n      const readingFactor = this.emfReading / 100;\n      return {\n        x: this.width / 2,\n        y: this.height / 2,\n        vx: (Math.random() - 0.5) * (2 + readingFactor * 5),\n        // More velocity with EMF\n        vy: (Math.random() - 0.5) * (2 + readingFactor * 5),\n        radius: Math.random() * 1.5 + 1 + readingFactor * 2,\n        // Larger radius with EMF\n        alpha: Math.random() * 0.5 + 0.3,\n        decay: Math.random() * 0.01 + 0.005\n      };\n    }\n    startAnimation() {\n      const animate = () => {\n        this.draw();\n        this.animationFrameId = requestAnimationFrame(animate);\n      };\n      animate();\n    }\n    draw() {\n      if (!this.ctx) return;\n      // Create a motion trail effect\n      this.ctx.fillStyle = 'rgba(0, 0, 0, 0.15)';\n      this.ctx.fillRect(0, 0, this.width, this.height);\n      const readingFactor = this.emfReading / 100;\n      // Brighter particles with higher EMF\n      const intensity = Math.min(1.5, 0.5 + readingFactor * 2);\n      this.particles.forEach(p => {\n        p.x += p.vx;\n        p.y += p.vy;\n        p.alpha -= p.decay;\n        if (p.alpha <= 0 || p.x < 0 || p.x > this.width || p.y < 0 || p.y > this.height) {\n          Object.assign(p, this.createParticle());\n          p.alpha = Math.random() * 0.5 + 0.3; // Reset alpha\n        }\n        this.ctx.beginPath();\n        this.ctx.arc(p.x, p.y, p.radius, 0, Math.PI * 2);\n        this.ctx.fillStyle = `rgba(110, 231, 183, ${p.alpha * intensity})`;\n        this.ctx.fill();\n      });\n    }\n    static #_ = _staticBlock = () => (this.ɵfac = function SpectralMapComponent_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || SpectralMapComponent)();\n    }, this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: SpectralMapComponent,\n      selectors: [[\"app-spectral-map\"]],\n      viewQuery: function SpectralMapComponent_Query(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵviewQuery(_c0, 5);\n        }\n        if (rf & 2) {\n          let _t;\n          i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.canvasRef = _t.first);\n        }\n      },\n      inputs: {\n        emfReading: \"emfReading\"\n      },\n      decls: 6,\n      vars: 0,\n      consts: [[\"spectralCanvas\", \"\"], [1, \"relative\", \"w-full\", \"h-48\", \"bg-black/50\", \"rounded-lg\", \"border-2\", \"border-green-900\", \"overflow-hidden\"], [1, \"absolute\", \"inset-0\", \"w-full\", \"h-full\"], [1, \"absolute\", \"inset-0\", \"bg-grid-pattern\", \"opacity-30\", \"pointer-events-none\"], [1, \"absolute\", \"top-2\", \"left-3\", \"text-xs\", \"text-green-400\", \"uppercase\", \"tracking-widest\", \"font-bold\"]],\n      template: function SpectralMapComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵdomElementStart(0, \"div\", 1);\n          i0.ɵɵdomElement(1, \"canvas\", 2, 0)(3, \"div\", 3);\n          i0.ɵɵdomElementStart(4, \"p\", 4);\n          i0.ɵɵtext(5, \"Spectral Map\");\n          i0.ɵɵdomElementEnd()();\n        }\n      },\n      styles: [\".bg-grid-pattern[_ngcontent-%COMP%]{background-image:linear-gradient(to right,rgba(0,255,0,.1) 1px,transparent 1px),linear-gradient(to bottom,rgba(0,255,0,.1) 1px,transparent 1px);background-size:20px 20px}\"],\n      changeDetection: 0\n    }));\n  }\n  _staticBlock();\n  return SpectralMapComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}