{"ast":null,"code":"import { effect } from '@angular/core';\nimport * as i0 from \"@angular/core\";\nconst _c0 = [\"spectralCanvas\"];\nexport let SpectralMapComponent = /*#__PURE__*/(() => {\n  var _staticBlock;\n  class SpectralMapComponent {\n    constructor() {\n      this.emfReading = 0;\n      this.particles = [];\n      this.animationFrameId = null;\n      this.width = 0;\n      this.height = 0;\n      effect(() => {\n        if (!this.ctx) return;\n        const reading = this.emfReading;\n        const targetParticleCount = Math.floor(reading / 100 * 350); // Increased density\n        while (this.particles.length < targetParticleCount) {\n          this.particles.push(this.createParticle());\n        }\n        while (this.particles.length > targetParticleCount && this.particles.length > 0) {\n          this.particles.pop();\n        }\n      });\n    }\n    ngAfterViewInit() {\n      const canvas = this.canvasRef.nativeElement;\n      const context = canvas.getContext('2d');\n      if (!context) {\n        console.error('Failed to get 2D context');\n        return;\n      }\n      this.ctx = context;\n      const rect = canvas.parentElement.getBoundingClientRect();\n      this.width = canvas.width = rect.width;\n      this.height = canvas.height = rect.height;\n      this.startAnimation();\n    }\n    ngOnDestroy() {\n      if (this.animationFrameId) {\n        cancelAnimationFrame(this.animationFrameId);\n      }\n    }\n    createParticle() {\n      const readingFactor = this.emfReading / 100;\n      return {\n        x: this.width / 2,\n        y: this.height / 2,\n        vx: (Math.random() - 0.5) * (2 + readingFactor * 5),\n        // More velocity with EMF\n        vy: (Math.random() - 0.5) * (2 + readingFactor * 5),\n        radius: Math.random() * 1.5 + 1 + readingFactor * 2,\n        // Larger radius with EMF\n        alpha: Math.random() * 0.5 + 0.3,\n        decay: Math.random() * 0.01 + 0.005\n      };\n    }\n    startAnimation() {\n      const animate = () => {\n        this.draw();\n        this.animationFrameId = requestAnimationFrame(animate);\n      };\n      animate();\n    }\n    draw() {\n      if (!this.ctx) return;\n      // Create a motion trail effect\n      this.ctx.fillStyle = 'rgba(0, 0, 0, 0.15)';\n      this.ctx.fillRect(0, 0, this.width, this.height);\n      const readingFactor = this.emfReading / 100;\n      // Brighter particles with higher EMF\n      const intensity = Math.min(1.5, 0.5 + readingFactor * 2);\n      this.particles.forEach(p => {\n        p.x += p.vx;\n        p.y += p.vy;\n        p.alpha -= p.decay;\n        if (p.alpha <= 0 || p.x < 0 || p.x > this.width || p.y < 0 || p.y > this.height) {\n          Object.assign(p, this.createParticle());\n          p.alpha = Math.random() * 0.5 + 0.3; // Reset alpha\n        }\n        this.ctx.beginPath();\n        this.ctx.arc(p.x, p.y, p.radius, 0, Math.PI * 2);\n        this.ctx.fillStyle = `rgba(110, 231, 183, ${p.alpha * intensity})`;\n        this.ctx.fill();\n      });\n    }\n    static #_ = _staticBlock = () => (this.ɵfac = function SpectralMapComponent_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || SpectralMapComponent)();\n    }, this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: SpectralMapComponent,\n      selectors: [[\"app-spectral-map\"]],\n      viewQuery: function SpectralMapComponent_Query(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵviewQuery(_c0, 5);\n        }\n        if (rf & 2) {\n          let _t;\n          i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.canvasRef = _t.first);\n        }\n      },\n      inputs: {\n        emfReading: \"emfReading\"\n      },\n      decls: 6,\n      vars: 0,\n      consts: [[\"spectralCanvas\", \"\"], [1, \"relative\", \"w-full\", \"h-48\", \"bg-black/50\", \"rounded-lg\", \"border-2\", \"border-green-900\", \"overflow-hidden\"], [1, \"absolute\", \"inset-0\", \"w-full\", \"h-full\"], [1, \"absolute\", \"inset-0\", \"bg-grid-pattern\", \"opacity-30\", \"pointer-events-none\"], [1, \"absolute\", \"top-2\", \"left-3\", \"text-xs\", \"text-green-400\", \"uppercase\", \"tracking-widest\", \"font-bold\"]],\n      template: function SpectralMapComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵdomElementStart(0, \"div\", 1);\n          i0.ɵɵdomElement(1, \"canvas\", 2, 0)(3, \"div\", 3);\n          i0.ɵɵdomElementStart(4, \"p\", 4);\n          i0.ɵɵtext(5, \"Spectral Map\");\n          i0.ɵɵdomElementEnd()();\n        }\n      },\n      styles: [\".bg-grid-pattern[_ngcontent-%COMP%] {\\n  background-image:\\n    linear-gradient(to right, rgba(0, 255, 0, 0.1) 1px, transparent 1px),\\n    linear-gradient(to bottom, rgba(0, 255, 0, 0.1) 1px, transparent 1px);\\n  background-size: 20px 20px;\\n}\\n\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9jb21wb25lbnRzL3NwZWN0cmFsLW1hcC9zcGVjdHJhbC1tYXAuY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQ0E7RUFDRTs7eUVBRXVFO0VBQ3ZFLDBCQUEwQjtBQUM1QiIsInNvdXJjZXNDb250ZW50IjpbIlxyXG4uYmctZ3JpZC1wYXR0ZXJuIHtcclxuICBiYWNrZ3JvdW5kLWltYWdlOlxyXG4gICAgbGluZWFyLWdyYWRpZW50KHRvIHJpZ2h0LCByZ2JhKDAsIDI1NSwgMCwgMC4xKSAxcHgsIHRyYW5zcGFyZW50IDFweCksXHJcbiAgICBsaW5lYXItZ3JhZGllbnQodG8gYm90dG9tLCByZ2JhKDAsIDI1NSwgMCwgMC4xKSAxcHgsIHRyYW5zcGFyZW50IDFweCk7XHJcbiAgYmFja2dyb3VuZC1zaXplOiAyMHB4IDIwcHg7XHJcbn1cclxuIl0sInNvdXJjZVJvb3QiOiIifQ== */\"],\n      changeDetection: 0\n    }));\n  }\n  _staticBlock();\n  return SpectralMapComponent;\n})();","map":{"version":3,"names":["effect","SpectralMapComponent","_staticBlock","constructor","emfReading","particles","animationFrameId","width","height","ctx","reading","targetParticleCount","Math","floor","length","push","createParticle","pop","ngAfterViewInit","canvas","canvasRef","nativeElement","context","getContext","console","error","rect","parentElement","getBoundingClientRect","startAnimation","ngOnDestroy","cancelAnimationFrame","readingFactor","x","y","vx","random","vy","radius","alpha","decay","animate","draw","requestAnimationFrame","fillStyle","fillRect","intensity","min","forEach","p","Object","assign","beginPath","arc","PI","fill","_","selectors","viewQuery","SpectralMapComponent_Query","rf","i0","ɵɵdomElementStart","ɵɵdomElement","ɵɵtext","ɵɵdomElementEnd"],"sources":["C:\\Users\\grand\\necrometer_-ghost-detector-1\\src\\components\\spectral-map\\spectral-map.component.ts","C:\\Users\\grand\\necrometer_-ghost-detector-1\\src\\components\\spectral-map\\spectral-map.component.html"],"sourcesContent":["\r\nimport { Component, ChangeDetectionStrategy, Input, effect, ViewChild, ElementRef, AfterViewInit, OnDestroy } from '@angular/core';\r\n\r\ninterface Particle {\r\n  x: number;\r\n  y: number;\r\n  vx: number;\r\n  vy: number;\r\n  radius: number;\r\n  alpha: number;\r\n  decay: number;\r\n}\r\n\r\n@Component({\r\n  selector: 'app-spectral-map',\r\n  templateUrl: './spectral-map.component.html',\r\n  styleUrls: ['./spectral-map.component.css'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush,\r\n})\r\nexport class SpectralMapComponent implements AfterViewInit, OnDestroy {\r\n  @Input() emfReading: number = 0;\r\n  @ViewChild('spectralCanvas') canvasRef!: ElementRef<HTMLCanvasElement>;\r\n\r\n  private ctx!: CanvasRenderingContext2D;\r\n  private particles: Particle[] = [];\r\n  private animationFrameId: number | null = null;\r\n  private width = 0;\r\n  private height = 0;\r\n\r\n  constructor() {\r\n    effect(() => {\r\n      if (!this.ctx) return;\r\n  const reading = this.emfReading;\r\n      const targetParticleCount = Math.floor((reading / 100) * 350); // Increased density\r\n      \r\n      while (this.particles.length < targetParticleCount) {\r\n        this.particles.push(this.createParticle());\r\n      }\r\n      while (this.particles.length > targetParticleCount && this.particles.length > 0) {\r\n        this.particles.pop();\r\n      }\r\n    });\r\n  }\r\n\r\n  ngAfterViewInit() {\r\n    const canvas = this.canvasRef.nativeElement;\r\n    const context = canvas.getContext('2d');\r\n    if (!context) {\r\n      console.error('Failed to get 2D context');\r\n      return;\r\n    }\r\n    this.ctx = context;\r\n\r\n    const rect = canvas.parentElement!.getBoundingClientRect();\r\n    this.width = canvas.width = rect.width;\r\n    this.height = canvas.height = rect.height;\r\n    \r\n    this.startAnimation();\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    if (this.animationFrameId) {\r\n      cancelAnimationFrame(this.animationFrameId);\r\n    }\r\n  }\r\n\r\n  private createParticle(): Particle {\r\n  const readingFactor = this.emfReading / 100;\r\n    return {\r\n      x: this.width / 2,\r\n      y: this.height / 2,\r\n      vx: (Math.random() - 0.5) * (2 + readingFactor * 5), // More velocity with EMF\r\n      vy: (Math.random() - 0.5) * (2 + readingFactor * 5),\r\n      radius: Math.random() * 1.5 + 1 + readingFactor * 2, // Larger radius with EMF\r\n      alpha: Math.random() * 0.5 + 0.3,\r\n      decay: Math.random() * 0.01 + 0.005,\r\n    };\r\n  }\r\n\r\n  private startAnimation() {\r\n    const animate = () => {\r\n      this.draw();\r\n      this.animationFrameId = requestAnimationFrame(animate);\r\n    };\r\n    animate();\r\n  }\r\n\r\n  private draw() {\r\n    if (!this.ctx) return;\r\n\r\n    // Create a motion trail effect\r\n    this.ctx.fillStyle = 'rgba(0, 0, 0, 0.15)';\r\n    this.ctx.fillRect(0, 0, this.width, this.height);\r\n\r\n  const readingFactor = this.emfReading / 100;\r\n    // Brighter particles with higher EMF\r\n    const intensity = Math.min(1.5, 0.5 + readingFactor * 2);\r\n\r\n    this.particles.forEach(p => {\r\n      p.x += p.vx;\r\n      p.y += p.vy;\r\n      p.alpha -= p.decay;\r\n\r\n      if (p.alpha <= 0 || p.x < 0 || p.x > this.width || p.y < 0 || p.y > this.height) {\r\n        Object.assign(p, this.createParticle());\r\n        p.alpha = Math.random() * 0.5 + 0.3; // Reset alpha\r\n      }\r\n      \r\n      this.ctx.beginPath();\r\n      this.ctx.arc(p.x, p.y, p.radius, 0, Math.PI * 2);\r\n      this.ctx.fillStyle = `rgba(110, 231, 183, ${p.alpha * intensity})`;\r\n      this.ctx.fill();\r\n    });\r\n  }\r\n}","\r\n<div class=\"relative w-full h-48 bg-black/50 rounded-lg border-2 border-green-900 overflow-hidden\">\r\n  <canvas #spectralCanvas class=\"absolute inset-0 w-full h-full\"></canvas>\r\n  <div class=\"absolute inset-0 bg-grid-pattern opacity-30 pointer-events-none\"></div>\r\n  <p class=\"absolute top-2 left-3 text-xs text-green-400 uppercase tracking-widest font-bold\">Spectral Map</p>\r\n</div>\r\n"],"mappings":"AACA,SAAoDA,MAAM,QAAyD,eAAe;;;AAkBlI,WAAaC,oBAAoB;EAAA,IAAAC,YAAA;EAA3B,MAAOD,oBAAoB;IAU/BE,YAAA;MATS,KAAAC,UAAU,GAAW,CAAC;MAIvB,KAAAC,SAAS,GAAe,EAAE;MAC1B,KAAAC,gBAAgB,GAAkB,IAAI;MACtC,KAAAC,KAAK,GAAG,CAAC;MACT,KAAAC,MAAM,GAAG,CAAC;MAGhBR,MAAM,CAAC,MAAK;QACV,IAAI,CAAC,IAAI,CAACS,GAAG,EAAE;QACnB,MAAMC,OAAO,GAAG,IAAI,CAACN,UAAU;QAC3B,MAAMO,mBAAmB,GAAGC,IAAI,CAACC,KAAK,CAAEH,OAAO,GAAG,GAAG,GAAI,GAAG,CAAC,CAAC,CAAC;QAE/D,OAAO,IAAI,CAACL,SAAS,CAACS,MAAM,GAAGH,mBAAmB,EAAE;UAClD,IAAI,CAACN,SAAS,CAACU,IAAI,CAAC,IAAI,CAACC,cAAc,EAAE,CAAC;QAC5C;QACA,OAAO,IAAI,CAACX,SAAS,CAACS,MAAM,GAAGH,mBAAmB,IAAI,IAAI,CAACN,SAAS,CAACS,MAAM,GAAG,CAAC,EAAE;UAC/E,IAAI,CAACT,SAAS,CAACY,GAAG,EAAE;QACtB;MACF,CAAC,CAAC;IACJ;IAEAC,eAAeA,CAAA;MACb,MAAMC,MAAM,GAAG,IAAI,CAACC,SAAS,CAACC,aAAa;MAC3C,MAAMC,OAAO,GAAGH,MAAM,CAACI,UAAU,CAAC,IAAI,CAAC;MACvC,IAAI,CAACD,OAAO,EAAE;QACZE,OAAO,CAACC,KAAK,CAAC,0BAA0B,CAAC;QACzC;MACF;MACA,IAAI,CAAChB,GAAG,GAAGa,OAAO;MAElB,MAAMI,IAAI,GAAGP,MAAM,CAACQ,aAAc,CAACC,qBAAqB,EAAE;MAC1D,IAAI,CAACrB,KAAK,GAAGY,MAAM,CAACZ,KAAK,GAAGmB,IAAI,CAACnB,KAAK;MACtC,IAAI,CAACC,MAAM,GAAGW,MAAM,CAACX,MAAM,GAAGkB,IAAI,CAAClB,MAAM;MAEzC,IAAI,CAACqB,cAAc,EAAE;IACvB;IAEAC,WAAWA,CAAA;MACT,IAAI,IAAI,CAACxB,gBAAgB,EAAE;QACzByB,oBAAoB,CAAC,IAAI,CAACzB,gBAAgB,CAAC;MAC7C;IACF;IAEQU,cAAcA,CAAA;MACtB,MAAMgB,aAAa,GAAG,IAAI,CAAC5B,UAAU,GAAG,GAAG;MACzC,OAAO;QACL6B,CAAC,EAAE,IAAI,CAAC1B,KAAK,GAAG,CAAC;QACjB2B,CAAC,EAAE,IAAI,CAAC1B,MAAM,GAAG,CAAC;QAClB2B,EAAE,EAAE,CAACvB,IAAI,CAACwB,MAAM,EAAE,GAAG,GAAG,KAAK,CAAC,GAAGJ,aAAa,GAAG,CAAC,CAAC;QAAE;QACrDK,EAAE,EAAE,CAACzB,IAAI,CAACwB,MAAM,EAAE,GAAG,GAAG,KAAK,CAAC,GAAGJ,aAAa,GAAG,CAAC,CAAC;QACnDM,MAAM,EAAE1B,IAAI,CAACwB,MAAM,EAAE,GAAG,GAAG,GAAG,CAAC,GAAGJ,aAAa,GAAG,CAAC;QAAE;QACrDO,KAAK,EAAE3B,IAAI,CAACwB,MAAM,EAAE,GAAG,GAAG,GAAG,GAAG;QAChCI,KAAK,EAAE5B,IAAI,CAACwB,MAAM,EAAE,GAAG,IAAI,GAAG;OAC/B;IACH;IAEQP,cAAcA,CAAA;MACpB,MAAMY,OAAO,GAAGA,CAAA,KAAK;QACnB,IAAI,CAACC,IAAI,EAAE;QACX,IAAI,CAACpC,gBAAgB,GAAGqC,qBAAqB,CAACF,OAAO,CAAC;MACxD,CAAC;MACDA,OAAO,EAAE;IACX;IAEQC,IAAIA,CAAA;MACV,IAAI,CAAC,IAAI,CAACjC,GAAG,EAAE;MAEf;MACA,IAAI,CAACA,GAAG,CAACmC,SAAS,GAAG,qBAAqB;MAC1C,IAAI,CAACnC,GAAG,CAACoC,QAAQ,CAAC,CAAC,EAAE,CAAC,EAAE,IAAI,CAACtC,KAAK,EAAE,IAAI,CAACC,MAAM,CAAC;MAElD,MAAMwB,aAAa,GAAG,IAAI,CAAC5B,UAAU,GAAG,GAAG;MACzC;MACA,MAAM0C,SAAS,GAAGlC,IAAI,CAACmC,GAAG,CAAC,GAAG,EAAE,GAAG,GAAGf,aAAa,GAAG,CAAC,CAAC;MAExD,IAAI,CAAC3B,SAAS,CAAC2C,OAAO,CAACC,CAAC,IAAG;QACzBA,CAAC,CAAChB,CAAC,IAAIgB,CAAC,CAACd,EAAE;QACXc,CAAC,CAACf,CAAC,IAAIe,CAAC,CAACZ,EAAE;QACXY,CAAC,CAACV,KAAK,IAAIU,CAAC,CAACT,KAAK;QAElB,IAAIS,CAAC,CAACV,KAAK,IAAI,CAAC,IAAIU,CAAC,CAAChB,CAAC,GAAG,CAAC,IAAIgB,CAAC,CAAChB,CAAC,GAAG,IAAI,CAAC1B,KAAK,IAAI0C,CAAC,CAACf,CAAC,GAAG,CAAC,IAAIe,CAAC,CAACf,CAAC,GAAG,IAAI,CAAC1B,MAAM,EAAE;UAC/E0C,MAAM,CAACC,MAAM,CAACF,CAAC,EAAE,IAAI,CAACjC,cAAc,EAAE,CAAC;UACvCiC,CAAC,CAACV,KAAK,GAAG3B,IAAI,CAACwB,MAAM,EAAE,GAAG,GAAG,GAAG,GAAG,CAAC,CAAC;QACvC;QAEA,IAAI,CAAC3B,GAAG,CAAC2C,SAAS,EAAE;QACpB,IAAI,CAAC3C,GAAG,CAAC4C,GAAG,CAACJ,CAAC,CAAChB,CAAC,EAAEgB,CAAC,CAACf,CAAC,EAAEe,CAAC,CAACX,MAAM,EAAE,CAAC,EAAE1B,IAAI,CAAC0C,EAAE,GAAG,CAAC,CAAC;QAChD,IAAI,CAAC7C,GAAG,CAACmC,SAAS,GAAG,uBAAuBK,CAAC,CAACV,KAAK,GAAGO,SAAS,GAAG;QAClE,IAAI,CAACrC,GAAG,CAAC8C,IAAI,EAAE;MACjB,CAAC,CAAC;IACJ;IAAC,QAAAC,CAAA,GAAAtD,YAAA,GAAAA,CAAA,M;uCA9FUD,oBAAoB;IAAA,G;YAApBA,oBAAoB;MAAAwD,SAAA;MAAAC,SAAA,WAAAC,2BAAAC,EAAA,EAAAnD,GAAA;QAAA,IAAAmD,EAAA;;;;;;;;;;;;;;;;UClBjCC,EAAA,CAAAC,iBAAA,aAAmG;UAEjGD,EADA,CAAAE,YAAA,mBAAwE,aACW;UACnFF,EAAA,CAAAC,iBAAA,WAA4F;UAAAD,EAAA,CAAAG,MAAA,mBAAY;UAC1GH,EAD0G,CAAAI,eAAA,EAAI,EACxG;;;;;;;;SDcOhE,oBAAoB;AAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}